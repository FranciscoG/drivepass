(function(){function e(e,t,n){for(var r=(n||0)-1,i=e?e.length:0;++r<i;)if(e[r]===t)return r;return-1}function t(e,t){for(var n=e.criteria,r=t.criteria,i=-1,o=n.length;++i<o;){var u=n[i],s=r[i];if(u!==s){if(u>s||"undefined"==typeof u)return 1;if(s>u||"undefined"==typeof s)return-1}}return e.index-t.index}function n(e){return"\\"+Fn[e]}function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,i=n-t||0,o=Array(0>i?0:i);++r<i;)o[r]=e[t+r];return o}function i(e){return e instanceof i?e:new o(e)}function o(e,t){this.__chain__=!!t,this.__wrapped__=e}function u(e){function t(){if(i){var e=r(i);Ln.apply(e,arguments)}if(this instanceof t){var u=s(n.prototype),a=n.apply(u,e||arguments);return B(a)?a:u}return n.apply(o,e||arguments)}var n=e[0],i=e[2],o=e[4];return t}function s(e){return B(e)?Nn(e):{}}function a(e,t,n){if("function"!=typeof e)return Mt;if("undefined"==typeof t||!("prototype"in e))return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,o){return e.call(t,n,r,i,o)}}return Et(e,t)}function c(e){function t(){var e=f?a:this;if(o){var v=r(o);Ln.apply(v,arguments)}if((u||h)&&(v||(v=r(arguments)),u&&Ln.apply(v,u),h&&v.length<l))return i|=16,c([n,g?i:-4&i,v,null,a,l]);if(v||(v=arguments),p&&(n=e[d]),this instanceof t){e=s(n.prototype);var m=n.apply(e,v);return B(m)?m:e}return n.apply(e,v)}var n=e[0],i=e[1],o=e[2],u=e[3],a=e[4],l=e[5],f=1&i,p=2&i,h=4&i,g=8&i,d=n;return t}function l(e,t){for(var n=-1,r=y(),i=e?e.length:0,o=[];++n<i;){var u=e[n];r(t,u)<0&&o.push(u)}return o}function f(e,t,n,r){for(var i=(r||0)-1,o=e?e.length:0,u=[];++i<o;){var s=e[i];if(s&&"object"==typeof s&&"number"==typeof s.length&&(zn(s)||b(s))){t||(s=f(s,t,n));var a=-1,c=s.length,l=u.length;for(u.length+=c;++a<c;)u[l++]=s[a]}else n||u.push(s)}return u}function p(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;var o=typeof e,u=typeof t;if(!(e!==e||e&&bn[o]||t&&bn[u]))return!1;if(null==e||null==t)return e===t;var s=En.call(e),a=En.call(t);if(s!=a)return!1;switch(s){case gn:case dn:return+e==+t;case mn:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case Tn:case _n:return e==String(t)}var c=s==hn;if(!c){var l=e instanceof i,f=t instanceof i;if(l||f)return p(l?e.__wrapped__:e,f?t.__wrapped__:t,n,r);if(s!=yn)return!1;var h=e.constructor,g=t.constructor;if(h!=g&&!(C(h)&&h instanceof h&&C(g)&&g instanceof g)&&"constructor"in e&&"constructor"in t)return!1}n||(n=[]),r||(r=[]);for(var d=n.length;d--;)if(n[d]==e)return r[d]==t;var v=!0,m=0;if(n.push(e),r.push(t),c){if(m=t.length,v=m==e.length)for(;m--&&(v=p(e[m],t[m],n,r)););}else er(t,function(t,i,o){return Bn.call(o,i)?(m++,!(v=Bn.call(e,i)&&p(e[i],t,n,r))&&sn):void 0}),v&&er(e,function(e,t,n){return Bn.call(n,t)?!(v=--m>-1)&&sn:void 0});return n.pop(),r.pop(),v}function h(e,t){return e+Cn(Jn()*(t-e+1))}function g(e,t,n){for(var r=-1,i=y(),o=e?e.length:0,u=[],s=n?[]:u;++r<o;){var a=e[r],c=n?n(a,r,e):a;(t?!r||s[s.length-1]!==c:i(s,c)<0)&&(n&&s.push(c),u.push(a))}return u}function d(e){return function(t,n,r){var i={};n=Ut(n,r,3);var o=-1,u=t?t.length:0;if("number"==typeof u)for(;++o<u;){var s=t[o];e(i,s,n(s,o,t),t)}else tr(t,function(t,r,o){e(i,t,n(t,r,o),o)});return i}}function v(e,t,n,r,i,o){var s=2&t,a=16&t,l=32&t;if(!s&&!C(e))throw new TypeError;a&&!n.length&&(t&=-17,a=n=!1),l&&!r.length&&(t&=-33,l=r=!1);var f=1==t||17===t?u:c;return f([e,t,n,r,i,o])}function m(e){return Vn[e]}function y(){var t=(t=i.indexOf)===mt?e:t;return t}function T(e){return"function"==typeof e&&In.test(e)}function _(e){return Kn[e]}function b(e){return e&&"object"==typeof e&&"number"==typeof e.length&&En.call(e)==pn||!1}function F(e){if(!e)return e;for(var t=1,n=arguments.length;n>t;t++){var r=arguments[t];if(r)for(var i in r)e[i]=r[i]}return e}function w(e){return B(e)?zn(e)?r(e):F({},e):e}function x(e){if(!e)return e;for(var t=1,n=arguments.length;n>t;t++){var r=arguments[t];if(r)for(var i in r)"undefined"==typeof e[i]&&(e[i]=r[i])}return e}function A(e){var t=[];return er(e,function(e,n){C(e)&&t.push(n)}),t.sort()}function D(e,t){return e?Bn.call(e,t):!1}function S(e){for(var t=-1,n=Wn(e),r=n.length,i={};++t<r;){var o=n[t];i[e[o]]=o}return i}function P(e){return e===!0||e===!1||e&&"object"==typeof e&&En.call(e)==gn||!1}function j(e){return e&&"object"==typeof e&&En.call(e)==dn||!1}function O(e){return e&&1===e.nodeType||!1}function E(e){if(!e)return!0;if(zn(e)||R(e))return!e.length;for(var t in e)if(Bn.call(e,t))return!1;return!0}function I(e,t){return p(e,t)}function Y(e){return Rn(e)&&!Xn(parseFloat(e))}function C(e){return"function"==typeof e}function B(e){return!(!e||!bn[typeof e])}function L(e){return N(e)&&e!=+e}function k(e){return null===e}function N(e){return"number"==typeof e||e&&"object"==typeof e&&En.call(e)==mn||!1}function q(e){return e&&bn[typeof e]&&En.call(e)==Tn||!1}function R(e){return"string"==typeof e||e&&"object"==typeof e&&En.call(e)==_n||!1}function X(e){return"undefined"==typeof e}function U(e){var t=[];er(e,function(e,n){t.push(n)}),t=l(t,f(arguments,!0,!1,1));for(var n=-1,r=t.length,i={};++n<r;){var o=t[n];i[o]=e[o]}return i}function $(e){for(var t=-1,n=Wn(e),r=n.length,i=Array(r);++t<r;){var o=n[t];i[t]=[o,e[o]]}return i}function M(e){for(var t=-1,n=f(arguments,!0,!1,1),r=n.length,i={};++t<r;){var o=n[t];o in e&&(i[o]=e[o])}return i}function J(e){for(var t=-1,n=Wn(e),r=n.length,i=Array(r);++t<r;)i[t]=e[n[t]];return i}function G(e,t){var n=y(),r=e?e.length:0,i=!1;return r&&"number"==typeof r?i=n(e,t)>-1:tr(e,function(e){return(i=e===t)&&sn}),i}function z(e,t,n){var r=!0;t=Ut(t,n,3);var i=-1,o=e?e.length:0;if("number"==typeof o)for(;++i<o&&(r=!!t(e[i],i,e)););else tr(e,function(e,n,i){return!(r=!!t(e,n,i))&&sn});return r}function H(e,t,n){var r=[];t=Ut(t,n,3);var i=-1,o=e?e.length:0;if("number"==typeof o)for(;++i<o;){var u=e[i];t(u,i,e)&&r.push(u)}else tr(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function W(e,t,n){t=Ut(t,n,3);var r=-1,i=e?e.length:0;if("number"!=typeof i){var o;return tr(e,function(e,n,r){return t(e,n,r)?(o=e,sn):void 0}),o}for(;++r<i;){var u=e[r];if(t(u,r,e))return u}}function V(e,t){return pt(e,t,!0)}function K(e,t,n){var r=-1,i=e?e.length:0;if(t=t&&"undefined"==typeof n?t:a(t,n,3),"number"==typeof i)for(;++r<i&&t(e[r],r,e)!==sn;);else tr(e,t)}function Q(e,t){var n=e?e.length:0;if("number"==typeof n)for(;n--&&t(e[n],n,e)!==!1;);else{var r=Wn(e);n=r.length,tr(e,function(e,i,o){return i=r?r[--n]:--n,t(o[i],i,o)===!1&&sn})}}function Z(e,t){var n=r(arguments,2),i=-1,o="function"==typeof t,u=e?e.length:0,s=Array("number"==typeof u?u:0);return K(e,function(e){s[++i]=(o?t:e[t]).apply(e,n)}),s}function et(e,t,n){var r=-1,i=e?e.length:0;if(t=Ut(t,n,3),"number"==typeof i)for(var o=Array(i);++r<i;)o[r]=t(e[r],r,e);else o=[],tr(e,function(e,n,i){o[++r]=t(e,n,i)});return o}function tt(e,t,n){var r=-1/0,i=r;"function"!=typeof t&&n&&n[t]===e&&(t=null);var o=-1,u=e?e.length:0;if(null==t&&"number"==typeof u)for(;++o<u;){var s=e[o];s>i&&(i=s)}else t=Ut(t,n,3),K(e,function(e,n,o){var u=t(e,n,o);u>r&&(r=u,i=e)});return i}function nt(e,t,n){var r=1/0,i=r;"function"!=typeof t&&n&&n[t]===e&&(t=null);var o=-1,u=e?e.length:0;if(null==t&&"number"==typeof u)for(;++o<u;){var s=e[o];i>s&&(i=s)}else t=Ut(t,n,3),K(e,function(e,n,o){var u=t(e,n,o);r>u&&(r=u,i=e)});return i}function rt(e,t,n,r){if(!e)return n;var i=arguments.length<3;t=Ut(t,r,4);var o=-1,u=e.length;if("number"==typeof u)for(i&&(n=e[++o]);++o<u;)n=t(n,e[o],o,e);else tr(e,function(e,r,o){n=i?(i=!1,e):t(n,e,r,o)});return n}function it(e,t,n,r){var i=arguments.length<3;return t=Ut(t,r,4),Q(e,function(e,r,o){n=i?(i=!1,e):t(n,e,r,o)}),n}function ot(e,t,n){return t=Ut(t,n,3),H(e,function(e,n,r){return!t(e,n,r)})}function ut(e,t,n){if(e&&"number"!=typeof e.length&&(e=J(e)),null==t||n)return e?e[h(0,e.length-1)]:on;var r=st(e);return r.length=Mn($n(0,t),r.length),r}function st(e){var t=-1,n=e?e.length:0,r=Array("number"==typeof n?n:0);return K(e,function(e){var n=h(0,++t);r[t]=r[n],r[n]=e}),r}function at(e){var t=e?e.length:0;return"number"==typeof t?t:Wn(e).length}function ct(e,t,n){var r;t=Ut(t,n,3);var i=-1,o=e?e.length:0;if("number"==typeof o)for(;++i<o&&!(r=t(e[i],i,e)););else tr(e,function(e,n,i){return(r=t(e,n,i))&&sn});return!!r}function lt(e,n,r){var i=-1,o=e?e.length:0,u=Array("number"==typeof o?o:0);for(n=Ut(n,r,3),K(e,function(e,t,r){u[++i]={criteria:[n(e,t,r)],index:i,value:e}}),o=u.length,u.sort(t);o--;)u[o]=u[o].value;return u}function ft(e){return zn(e)?r(e):e&&"number"==typeof e.length?et(e):J(e)}function pt(e,t,n){return n&&E(t)?on:(n?W:H)(e,t)}function ht(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var i=e[t];i&&r.push(i)}return r}function gt(e){return l(e,f(arguments,!0,!0,1))}function dt(e,t,n){var i=0,o=e?e.length:0;if("number"!=typeof t&&null!=t){var u=-1;for(t=Ut(t,n,3);++u<o&&t(e[u],u,e);)i++}else if(i=t,null==i||n)return e?e[0]:on;return r(e,0,Mn($n(0,i),o))}function vt(e,t){return f(e,t)}function mt(t,n,r){if("number"==typeof r){var i=t?t.length:0;r=0>r?$n(0,i+r):r||0}else if(r){var o=xt(t,n);return t[o]===n?o:-1}return e(t,n,r)}function yt(e,t,n){var i=0,o=e?e.length:0;if("number"!=typeof t&&null!=t){var u=o;for(t=Ut(t,n,3);u--&&t(e[u],u,e);)i++}else i=null==t||n?1:t||i;return r(e,0,Mn($n(0,o-i),o))}function Tt(){for(var e=[],t=-1,n=arguments.length;++t<n;){var r=arguments[t];(zn(r)||b(r))&&e.push(r)}var i=e[0],o=-1,u=y(),s=i?i.length:0,a=[];e:for(;++o<s;)if(r=i[o],u(a,r)<0){for(var t=n;--t;)if(u(e[t],r)<0)continue e;a.push(r)}return a}function _t(e,t,n){var i=0,o=e?e.length:0;if("number"!=typeof t&&null!=t){var u=o;for(t=Ut(t,n,3);u--&&t(e[u],u,e);)i++}else if(i=t,null==i||n)return e?e[o-1]:on;return r(e,$n(0,o-i))}function bt(e,t,n){var r=e?e.length:0;for("number"==typeof n&&(r=(0>n?$n(0,r+n):Mn(n,r-1))+1);r--;)if(e[r]===t)return r;return-1}function Ft(e,t,n){e=+e||0,n=+n||1,null==t&&(t=e,e=0);for(var r=-1,i=$n(0,Yn((t-e)/n)),o=Array(i);++r<i;)o[r]=e,e+=n;return o}function wt(e,t,n){if("number"!=typeof t&&null!=t){var i=0,o=-1,u=e?e.length:0;for(t=Ut(t,n,3);++o<u&&t(e[o],o,e);)i++}else i=null==t||n?1:$n(0,t);return r(e,i)}function xt(e,t,n,r){var i=0,o=e?e.length:i;for(n=n?Ut(n,r,1):Mt,t=n(t);o>i;){var u=i+o>>>1;n(e[u])<t?i=u+1:o=u}return i}function At(){return g(f(arguments,!0,!0))}function Dt(e,t,n,r){return"boolean"!=typeof t&&null!=t&&(r=n,n="function"!=typeof t&&r&&r[t]===e?null:t,t=!1),null!=n&&(n=Ut(n,r,3)),g(e,t,n)}function St(e){return l(e,r(arguments,1))}function Pt(){for(var e=-1,t=tt(or(arguments,"length")),n=Array(0>t?0:t);++e<t;)n[e]=or(arguments,e);return n}function jt(e,t){var n=-1,r=e?e.length:0,i={};for(t||!r||zn(e[0])||(t=[]);++n<r;){var o=e[n];t?i[o]=t[n]:o&&(i[o[0]]=o[1])}return i}function Ot(e,t){if(!C(t))throw new TypeError;return function(){return--e<1?t.apply(this,arguments):void 0}}function Et(e,t){return arguments.length>2?v(e,17,r(arguments,2),null,t):v(e,1,null,null,t)}function It(e){for(var t=arguments.length>1?f(arguments,!0,!1,1):A(e),n=-1,r=t.length;++n<r;){var i=t[n];e[i]=v(e[i],1,null,null,e)}return e}function Yt(){for(var e=arguments,t=e.length;t--;)if(!C(e[t]))throw new TypeError;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}}function Ct(e,t,n){var r,i,o,u,s,a,c,l=0,f=!1,p=!0;if(!C(e))throw new TypeError;if(t=$n(0,t)||0,n===!0){var h=!0;p=!1}else B(n)&&(h=n.leading,f="maxWait"in n&&($n(t,n.maxWait)||0),p="trailing"in n?n.trailing:p);var g=function(){var n=t-(ur()-u);if(0>=n){i&&clearTimeout(i);var f=c;i=a=c=on,f&&(l=ur(),o=e.apply(s,r),a||i||(r=s=null))}else a=setTimeout(g,n)},d=function(){a&&clearTimeout(a),i=a=c=on,(p||f!==t)&&(l=ur(),o=e.apply(s,r),a||i||(r=s=null))};return function(){if(r=arguments,u=ur(),s=this,c=p&&(a||!h),f===!1)var n=h&&!a;else{i||h||(l=u);var v=f-(u-l),m=0>=v;m?(i&&(i=clearTimeout(i)),l=u,o=e.apply(s,r)):i||(i=setTimeout(d,v))}return m&&a?a=clearTimeout(a):a||t===f||(a=setTimeout(g,t)),n&&(m=!0,o=e.apply(s,r)),!m||a||i||(r=s=null),o}}function Bt(e){if(!C(e))throw new TypeError;var t=r(arguments,1);return setTimeout(function(){e.apply(on,t)},1)}function Lt(e,t){if(!C(e))throw new TypeError;var n=r(arguments,2);return setTimeout(function(){e.apply(on,n)},t)}function kt(e,t){var n={};return function(){var r=t?t.apply(this,arguments):an+arguments[0];return Bn.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}}function Nt(e){var t,n;if(!C(e))throw new TypeError;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function qt(e){return v(e,16,r(arguments,1))}function Rt(e,t,n){var r=!0,i=!0;if(!C(e))throw new TypeError;return n===!1?r=!1:B(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),n={},n.leading=r,n.maxWait=t,n.trailing=i,Ct(e,t,n)}function Xt(e,t){return v(t,16,[e])}function Ut(e,t,n){var r=typeof e;if(null==e||"function"==r)return a(e,t,n);if("object"!=r)return zt(e);var i=Wn(e);return function(t){for(var n=i.length,r=!1;n--&&(r=t[i[n]]===e[i[n]]););return r}}function $t(e){return null==e?"":String(e).replace(Zn,m)}function Mt(e){return e}function Jt(e){K(A(e),function(t){var n=i[t]=e[t];i.prototype[t]=function(){var e=[this.__wrapped__];Ln.apply(e,arguments);var t=n.apply(i,e);return this.__chain__?new o(t,!0):t}})}function Gt(){return wn._=On,this}function zt(e){return function(t){return t[e]}}function Ht(e,t){return null==e&&null==t&&(t=1),e=+e||0,null==t?(t=e,e=0):t=+t||0,e+Cn(Jn()*(t-e+1))}function Wt(e,t){if(e){var n=e[t];return C(n)?e[t]():n}}function Vt(e,t,r){var o=i,u=o.templateSettings;e=String(e||""),r=x({},r,u);var s=0,a="__p += '",c=r.variable,l=RegExp((r.escape||ln).source+"|"+(r.interpolate||ln).source+"|"+(r.evaluate||ln).source+"|$","g");e.replace(l,function(t,r,i,o,u){return a+=e.slice(s,u).replace(fn,n),r&&(a+="' +\n_.escape("+r+") +\n'"),o&&(a+="';\n"+o+";\n__p += '"),i&&(a+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),s=u+t.length,t}),a+="';\n",c||(c="obj",a="with ("+c+" || {}) {\n"+a+"\n}\n"),a="function("+c+") {\nvar __t, __p = '', __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n"+a+"return __p\n}";try{var f=Function("_","return "+a)(o)}catch(p){throw p.source=a,p}return t?f(t):(f.source=a,f)}function Kt(e,t,n){e=(e=+e)>-1?e:0;var r=-1,i=Array(e);for(t=a(t,n,1);++r<e;)i[r]=t(r);return i}function Qt(e){return null==e?"":String(e).replace(Qn,_)}function Zt(e){var t=++un+"";return e?e+t:t}function en(e){return e=new o(e),e.__chain__=!0,e}function tn(e,t){return t(e),e}function nn(){return this.__chain__=!0,this}function rn(){return this.__wrapped__}var on,un=0,sn={},an=+new Date+"",cn=/<%=([\s\S]+?)%>/g,ln=/($^)/,fn=/['\n\r\t\u2028\u2029\\]/g,pn="[object Arguments]",hn="[object Array]",gn="[object Boolean]",dn="[object Date]",vn="[object Function]",mn="[object Number]",yn="[object Object]",Tn="[object RegExp]",_n="[object String]",bn={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},Fn={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},wn=bn[typeof window]&&window||this,xn=bn[typeof exports]&&exports&&!exports.nodeType&&exports,An=bn[typeof module]&&module&&!module.nodeType&&module,Dn=An&&An.exports===xn&&xn,Sn=bn[typeof global]&&global;!Sn||Sn.global!==Sn&&Sn.window!==Sn||(wn=Sn);var Pn=[],jn=Object.prototype,On=wn._,En=jn.toString,In=RegExp("^"+String(En).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Yn=Math.ceil,Cn=Math.floor,Bn=jn.hasOwnProperty,Ln=Pn.push,kn=jn.propertyIsEnumerable,Nn=T(Nn=Object.create)&&Nn,qn=T(qn=Array.isArray)&&qn,Rn=wn.isFinite,Xn=wn.isNaN,Un=T(Un=Object.keys)&&Un,$n=Math.max,Mn=Math.min,Jn=Math.random;o.prototype=i.prototype;var Gn={};!function(){var e={0:1,length:1};Gn.spliceObjects=(Pn.splice.call(e,0,1),!e[0])}(1),i.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:cn,variable:""},Nn||(s=function(){function e(){}return function(t){if(B(t)){e.prototype=t;var n=new e;e.prototype=null}return n||wn.Object()}}()),b(arguments)||(b=function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Bn.call(e,"callee")&&!kn.call(e,"callee")||!1});var zn=qn||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&En.call(e)==hn||!1},Hn=function(e){var t,n=e,r=[];if(!n)return r;if(!bn[typeof e])return r;for(t in n)Bn.call(n,t)&&r.push(t);return r},Wn=Un?function(e){return B(e)?Un(e):[]}:Hn,Vn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},Kn=S(Vn),Qn=RegExp("("+Wn(Kn).join("|")+")","g"),Zn=RegExp("["+Wn(Vn).join("")+"]","g"),er=function(e,t){var n,r=e,i=r;if(!r)return i;if(!bn[typeof r])return i;for(n in r)if(t(r[n],n,e)===sn)return i;return i},tr=function(e,t){var n,r=e,i=r;if(!r)return i;if(!bn[typeof r])return i;for(n in r)if(Bn.call(r,n)&&t(r[n],n,e)===sn)return i;return i};C(/x/)&&(C=function(e){return"function"==typeof e&&En.call(e)==vn});var nr=d(function(e,t,n){Bn.call(e,n)?e[n]++:e[n]=1}),rr=d(function(e,t,n){(Bn.call(e,n)?e[n]:e[n]=[]).push(t)}),ir=d(function(e,t,n){e[n]=t}),or=et,ur=T(ur=Date.now)&&ur||function(){return(new Date).getTime()};i.after=Ot,i.bind=Et,i.bindAll=It,i.chain=en,i.compact=ht,i.compose=Yt,i.countBy=nr,i.debounce=Ct,i.defaults=x,i.defer=Bt,i.delay=Lt,i.difference=gt,i.filter=H,i.flatten=vt,i.forEach=K,i.functions=A,i.groupBy=rr,i.indexBy=ir,i.initial=yt,i.intersection=Tt,i.invert=S,i.invoke=Z,i.keys=Wn,i.map=et,i.max=tt,i.memoize=kt,i.min=nt,i.omit=U,i.once=Nt,i.pairs=$,i.partial=qt,i.pick=M,i.pluck=or,i.range=Ft,i.reject=ot,i.rest=wt,i.shuffle=st,i.sortBy=lt,i.tap=tn,i.throttle=Rt,i.times=Kt,i.toArray=ft,i.union=At,i.uniq=Dt,i.values=J,i.where=pt,i.without=St,i.wrap=Xt,i.zip=Pt,i.collect=et,i.drop=wt,i.each=K,i.extend=F,i.methods=A,i.object=jt,i.select=H,i.tail=wt,i.unique=Dt,i.clone=w,i.contains=G,i.escape=$t,i.every=z,i.find=W,i.has=D,i.identity=Mt,i.indexOf=mt,i.isArguments=b,i.isArray=zn,i.isBoolean=P,i.isDate=j,i.isElement=O,i.isEmpty=E,i.isEqual=I,i.isFinite=Y,i.isFunction=C,i.isNaN=L,i.isNull=k,i.isNumber=N,i.isObject=B,i.isRegExp=q,i.isString=R,i.isUndefined=X,i.lastIndexOf=bt,i.mixin=Jt,i.noConflict=Gt,i.random=Ht,i.reduce=rt,i.reduceRight=it,i.result=Wt,i.size=at,i.some=ct,i.sortedIndex=xt,i.template=Vt,i.unescape=Qt,i.uniqueId=Zt,i.all=z,i.any=ct,i.detect=W,i.findWhere=V,i.foldl=rt,i.foldr=it,i.include=G,i.inject=rt,i.first=dt,i.last=_t,i.sample=ut,i.take=dt,i.head=dt,Jt(i),i.VERSION="2.4.1",i.prototype.chain=nn,i.prototype.value=rn,K(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=Pn[e];i.prototype[e]=function(){var e=this.__wrapped__;return t.apply(e,arguments),Gn.spliceObjects||0!==e.length||delete e[0],this}}),K(["concat","join","slice"],function(e){var t=Pn[e];i.prototype[e]=function(){var e=this.__wrapped__,n=t.apply(e,arguments);return this.__chain__&&(n=new o(n),n.__chain__=!0),n}}),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(wn._=i,define(function(){return i})):xn&&An?Dn?(An.exports=i)._=i:xn._=i:wn._=i}).call(this);var TAFFY,exports,T;!function(){var e,t,n,r,i,o,u,s,a,c,l,f,p,h,g,d,v,m,y,_,b,F,w;if(!TAFFY)for(i="2.7",o=1,u="000000",s=1e3,a={},c=function(e){return TAFFY.isArray(e)||TAFFY.isObject(e)?e:JSON.parse(e)},y=function(e,t){return _(e,function(e){return t.indexOf(e)>=0})},_=function(e,t,n){var r=[];return null==e?r:Array.prototype.filter&&e.filter===Array.prototype.filter?e.filter(t,n):(l(e,function(e,i,o){t.call(n,e,i,o)&&(r[r.length]=e)}),r)},w=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},F=function(e){var t=T.isArray(e)?[]:T.isObject(e)?{}:null;if(null===e)return e;for(var n in e)t[n]=w(e[n])?e[n].toString():T.isArray(e[n])||T.isObject(e[n])?F(e[n]):e[n];return t},b=function(e){var t=JSON.stringify(e);return null===t.match(/regex/)?t:JSON.stringify(F(e))},l=function(e,t,n){var r,i,o,u;if(e&&(T.isArray(e)&&1===e.length||!T.isArray(e)))t(T.isArray(e)?e[0]:e,0);else for(o=0,e=T.isArray(e)?e:[e],u=e.length;u>o&&(i=e[o],T.isUndefined(i)&&!n||(r=t(i,o),r!==T.EXIT));o++);},f=function(e,t){var n,r,i=0;for(r in e)if(e.hasOwnProperty(r)&&(n=t(e[r],r,i++),n===T.EXIT))break},a.extend=function(e,t){a[e]=function(){return t.apply(this,arguments)}},p=function(e){var t;return T.isString(e)&&/[t][0-9]*[r][0-9]*/i.test(e)?!0:T.isObject(e)&&e.___id&&e.___s?!0:T.isArray(e)?(t=!0,l(e,function(e){return p(e)?void 0:(t=!1,TAFFY.EXIT)}),t):!1},g=function(e,t){var n=!0;return l(t,function(t){switch(T.typeOf(t)){case"function":if(!t.apply(e))return n=!1,TAFFY.EXIT;break;case"array":n=1===t.length?g(e,t[0]):2===t.length?g(e,t[0])||g(e,t[1]):3===t.length?g(e,t[0])||g(e,t[1])||g(e,t[2]):4===t.length?g(e,t[0])||g(e,t[1])||g(e,t[2])||g(e,t[3]):!1,t.length>4&&l(t,function(t){g(e,t)&&(n=!0)})}}),n},h=function(e){var t=[];return T.isString(e)&&/[t][0-9]*[r][0-9]*/i.test(e)&&(e={___id:e}),T.isArray(e)?(l(e,function(e){t.push(h(e))}),e=function(){var e=this,n=!1;return l(t,function(t){g(e,t)&&(n=!0)}),n}):T.isObject(e)?(T.isObject(e)&&e.___id&&e.___s&&(e={___id:e.___id}),f(e,function(e,n){T.isObject(e)||(e={is:e}),f(e,function(e,r){var i,o=[];i="hasAll"===r?function(e,t){t(e)}:l,i(e,function(e){var t,i=!0;t=function(){var t,o=this[n],u="==",s="!=",a="===",c="<",l=">",f="<=",p=">=",h="!==";return"undefined"==typeof o?!1:(0===r.indexOf("!")&&r!==s&&r!==h&&(i=!1,r=r.substring(1,r.length)),t="regex"===r?e.test(o):"lt"===r||r===c?e>o:"gt"===r||r===l?o>e:"lte"===r||r===f?e>=o:"gte"===r||r===p?o>=e:"left"===r?0===o.indexOf(e):"leftnocase"===r?0===o.toLowerCase().indexOf(e.toLowerCase()):"right"===r?o.substring(o.length-e.length)===e:"rightnocase"===r?o.toLowerCase().substring(o.length-e.length)===e.toLowerCase():"like"===r?o.indexOf(e)>=0:"likenocase"===r?o.toLowerCase().indexOf(e.toLowerCase())>=0:r===a||"is"===r?o===e:r===u?o==e:r===h?o!==e:r===s?o!=e:"isnocase"===r?o.toLowerCase?o.toLowerCase()===e.toLowerCase():o===e:"has"===r?T.has(o,e):"hasall"===r?T.hasAll(o,e):"contains"===r?TAFFY.isArray(o)&&o.indexOf(e)>-1:-1!==r.indexOf("is")||TAFFY.isNull(o)||TAFFY.isUndefined(o)||TAFFY.isObject(e)||TAFFY.isArray(e)?T[r]&&T.isFunction(T[r])&&0===r.indexOf("is")?T[r](o)===e:T[r]&&T.isFunction(T[r])?T[r](o,e):!1:e===o[r],t=t&&!i?!1:t||i?t:!0)},o.push(t)}),t.push(1===o.length?o[0]:function(){var e=this,t=!1;return l(o,function(n){n.apply(e)&&(t=!0)}),t})})}),e=function(){var e=this,n=!0;return n=1!==t.length||t[0].apply(e)?2!==t.length||t[0].apply(e)&&t[1].apply(e)?3!==t.length||t[0].apply(e)&&t[1].apply(e)&&t[2].apply(e)?4!==t.length||t[0].apply(e)&&t[1].apply(e)&&t[2].apply(e)&&t[3].apply(e)?!0:!1:!1:!1:!1,t.length>4&&l(t,function(t){g(e,t)||(n=!1)}),n}):T.isFunction(e)?e:void 0},v=function(e,t){var n=function(e,n){var r=0;return T.each(t,function(t){var i,o,u,s,a;if(i=t.split(" "),o=i[0],u=1===i.length?"logical":i[1],"logical"===u)s=d(e[o]),a=d(n[o]),T.each(s.length<=a.length?s:a,function(e,t){return s[t]<a[t]?(r=-1,TAFFY.EXIT):s[t]>a[t]?(r=1,TAFFY.EXIT):void 0});else if("logicaldesc"===u)s=d(e[o]),a=d(n[o]),T.each(s.length<=a.length?s:a,function(e,t){return s[t]>a[t]?(r=-1,TAFFY.EXIT):s[t]<a[t]?(r=1,TAFFY.EXIT):void 0});else{if("asec"===u&&e[o]<n[o])return r=-1,T.EXIT;if("asec"===u&&e[o]>n[o])return r=1,T.EXIT;if("desc"===u&&e[o]>n[o])return r=-1,T.EXIT;if("desc"===u&&e[o]<n[o])return r=1,T.EXIT}return 0===r&&"logical"===u&&s.length<a.length?r=-1:0===r&&"logical"===u&&s.length>a.length?r=1:0===r&&"logicaldesc"===u&&s.length>a.length?r=-1:0===r&&"logicaldesc"===u&&s.length<a.length&&(r=1),0!==r?T.EXIT:void 0}),r};return e&&e.push?e.sort(n):e},function(){var e={},t=0;d=function(n){return t>s&&(e={},t=0),e["_"+n]||function(){var r,i,o,u=String(n),s=[],a="_",c="";for(r=0,i=u.length;i>r;r++)o=u.charCodeAt(r),o>=48&&57>=o||46===o?("n"!==c&&(c="n",s.push(a.toLowerCase()),a=""),a+=u.charAt(r)):("s"!==c&&(c="s",s.push(parseFloat(a)),a=""),a+=u.charAt(r));return s.push("n"===c?parseFloat(a):a.toLowerCase()),s.shift(),e["_"+n]=s,t++,s}()}}(),m=function(){this.context({results:this.getDBI().query(this.context())})},a.extend("filter",function(){var e=TAFFY.mergeObj(this.context(),{run:null}),t=[];return l(e.q,function(e){t.push(e)}),e.q=t,l(arguments,function(t){e.q.push(h(t)),e.filterRaw.push(t)}),this.getroot(e)}),a.extend("order",function(e){e=e.split(",");var t,n=[];return l(e,function(e){n.push(e.replace(/^\s*/,"").replace(/\s*$/,""))}),t=TAFFY.mergeObj(this.context(),{sort:null}),t.order=n,this.getroot(t)}),a.extend("limit",function(e){var t,n=TAFFY.mergeObj(this.context(),{});return n.limit=e,n.run&&n.sort&&(t=[],l(n.results,function(n,r){return r+1>e?TAFFY.EXIT:void t.push(n)}),n.results=t),this.getroot(n)}),a.extend("start",function(e){var t,n=TAFFY.mergeObj(this.context(),{});return n.start=e,n.run&&n.sort&&!n.limit?(t=[],l(n.results,function(n,r){r+1>e&&t.push(n)}),n.results=t):n=TAFFY.mergeObj(this.context(),{run:null,start:e}),this.getroot(n)}),a.extend("update",function(e,t,n){var r,i=!0,o={},u=arguments;return!TAFFY.isString(e)||2!==arguments.length&&3!==arguments.length?(o=e,2===u.length&&(i=t)):(o[e]=t,3===arguments.length&&(i=n)),r=this,m.call(this),l(this.context().results,function(e){var t=o;TAFFY.isFunction(t)?t=t.apply(TAFFY.mergeObj(e,{})):T.isFunction(t)&&(t=t(TAFFY.mergeObj(e,{}))),TAFFY.isObject(t)&&r.getDBI().update(e.___id,t,i)}),this.context().results.length&&this.context({run:null}),this}),a.extend("remove",function(e){var t=this,n=0;return m.call(this),l(this.context().results,function(e){t.getDBI().remove(e.___id),n++}),this.context().results.length&&(this.context({run:null}),t.getDBI().removeCommit(e)),n}),a.extend("count",function(){return m.call(this),this.context().results.length}),a.extend("callback",function(e,t){if(e){var n=this;setTimeout(function(){m.call(n),e.call(n.getroot(n.context()))},t||0)}return null}),a.extend("get",function(){return m.call(this),this.context().results}),a.extend("stringify",function(){return JSON.stringify(this.get())}),a.extend("first",function(){return m.call(this),this.context().results[0]||!1}),a.extend("last",function(){return m.call(this),this.context().results[this.context().results.length-1]||!1}),a.extend("sum",function(){var e=0,t=this;return m.call(t),l(arguments,function(n){l(t.context().results,function(t){e+=t[n]||0})}),e}),a.extend("min",function(e){var t=null;return m.call(this),l(this.context().results,function(n){(null===t||n[e]<t)&&(t=n[e])}),t}),function(){var e=function(){var e,t,n;return e=function(e,t,n){var r,i,o;switch(2===n.length?(r=e[n[0]],o="===",i=t[n[1]]):(r=e[n[0]],o=n[1],i=t[n[2]]),o){case"===":return r===i;case"!==":return r!==i;case"<":return i>r;case">":return r>i;case"<=":return i>=r;case">=":return r>=i;case"==":return r==i;case"!=":return r!=i;default:throw String(o)+" is not supported"}},t=function(e,t){var n,r,i={};for(n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);for(n in t)t.hasOwnProperty(n)&&"___id"!==n&&"___s"!==n&&(r=TAFFY.isUndefined(i[n])?"":"right_",i[r+String(n)]=t[n]);return i},n=function(n){var r,i,o=arguments,u=o.length,s=[];if("function"!=typeof n.filter){if(!n.TAFFY)throw"TAFFY DB or result not supplied";r=n()}else r=n;return this.context({results:this.getDBI().query(this.context())}),TAFFY.each(this.context().results,function(n){r.each(function(r){var a,c=!0;e:for(i=1;u>i&&(a=o[i],c="function"==typeof a?a(n,r):"object"==typeof a&&a.length?e(n,r,a):!1,c);i++);c&&s.push(t(n,r))})}),TAFFY(s)()}}();a.extend("join",e)}(),a.extend("max",function(e){var t=null;return m.call(this),l(this.context().results,function(n){(null===t||n[e]>t)&&(t=n[e])}),t}),a.extend("select",function(){var e=[],t=arguments;return m.call(this),1===arguments.length?l(this.context().results,function(n){e.push(n[t[0]])}):l(this.context().results,function(n){var r=[];l(t,function(e){r.push(n[e])}),e.push(r)}),e}),a.extend("distinct",function(){var e=[],t=arguments;return m.call(this),1===arguments.length?l(this.context().results,function(n){var r=n[t[0]],i=!1;l(e,function(e){return r===e?(i=!0,TAFFY.EXIT):void 0}),i||e.push(r)}):l(this.context().results,function(n){var r=[],i=!1;l(t,function(e){r.push(n[e])}),l(e,function(e){var n=!0;return l(t,function(t,i){return r[i]!==e[i]?(n=!1,TAFFY.EXIT):void 0}),n?(i=!0,TAFFY.EXIT):void 0}),i||e.push(r)}),e}),a.extend("supplant",function(e,t){var n=[];return m.call(this),l(this.context().results,function(t){n.push(e.replace(/\{([^\{\}]*)\}/g,function(e,n){var r=t[n];return"string"==typeof r||"number"==typeof r?r:e}))}),t?n:n.join("")}),a.extend("each",function(e){return m.call(this),l(this.context().results,e),this}),a.extend("map",function(e){var t=[];return m.call(this),l(this.context().results,function(n){t.push(e(n))}),t}),T=function(e){var t,n,r,i=[],s={},d=1,m={template:!1,onInsert:!1,onUpdate:!1,onRemove:!1,onDBChange:!1,storageName:!1,forcePropertyCase:null,cacheSize:100,name:""},y=new Date,_=0,F=0,w={};return n=function(e){var t=[],r=!1;return 0===e.length?i:(l(e,function(e){T.isString(e)&&/[t][0-9]*[r][0-9]*/i.test(e)&&i[s[e]]&&(t.push(i[s[e]]),r=!0),T.isObject(e)&&e.___id&&e.___s&&i[s[e.___id]]&&(t.push(i[s[e.___id]]),r=!0),T.isArray(e)&&l(e,function(e){l(n(e),function(e){t.push(e)})})}),r&&t.length>1&&(t=[]),t)},t={dm:function(e){return e&&(y=e,w={},_=0,F=0),m.onDBChange&&setTimeout(function(){m.onDBChange.call(i)},0),m.storageName&&setTimeout(function(){localStorage.setItem("taffy_"+m.storageName,JSON.stringify(i))}),y},insert:function(e,n){var a=[],p=[],h=c(e);return l(h,function(e,r){var c,h;return T.isArray(e)&&0===r?(l(e,function(e){a.push("lower"===m.forcePropertyCase?e.toLowerCase():"upper"===m.forcePropertyCase?e.toUpperCase():e)}),!0):(T.isArray(e)?(c={},l(e,function(e,t){c[a[t]]=e}),e=c):T.isObject(e)&&m.forcePropertyCase&&(h={},f(e,function(t,n){h["lower"===m.forcePropertyCase?n.toLowerCase():"upper"===m.forcePropertyCase?n.toUpperCase():n]=e[n]}),e=h),d++,e.___id="T"+String(u+o).slice(-6)+"R"+String(u+d).slice(-6),e.___s=!0,p.push(e.___id),m.template&&(e=T.mergeObj(m.template,e)),i.push(e),s[e.___id]=i.length-1,m.onInsert&&(n||TAFFY.isUndefined(n))&&m.onInsert.call(e),void t.dm(new Date))}),r(p)},sort:function(e){return i=v(i,e.split(",")),s={},l(i,function(e,t){s[e.___id]=t}),t.dm(new Date),!0},update:function(e,n,r){var o,u,a,c,l={};m.forcePropertyCase&&(f(n,function(e,t){l["lower"===m.forcePropertyCase?t.toLowerCase():"upper"===m.forcePropertyCase?t.toUpperCase():t]=e}),n=l),o=i[s[e]],u=T.mergeObj(o,n),a={},c=!1,f(u,function(e,t){(TAFFY.isUndefined(o[t])||o[t]!==e)&&(a[t]=e,c=!0)}),c&&(m.onUpdate&&(r||TAFFY.isUndefined(r))&&m.onUpdate.call(u,i[s[e]],a),i[s[e]]=u,t.dm(new Date))},remove:function(e){i[s[e]].___s=!1},removeCommit:function(e){var n;for(n=i.length-1;n>-1;n--)i[n].___s||(m.onRemove&&(e||TAFFY.isUndefined(e))&&m.onRemove.call(i[n]),s[i[n].___id]=void 0,i.splice(n,1));s={},l(i,function(e,t){s[e.___id]=t}),t.dm(new Date)},query:function(e){var r,o,u,s,a,c;if(m.cacheSize&&(o="",l(e.filterRaw,function(e){return T.isFunction(e)?(o="nocache",TAFFY.EXIT):void 0}),""===o&&(o=b(T.mergeObj(e,{q:!1,run:!1,sort:!1})))),!e.results||!e.run||e.run&&t.dm()>e.run){if(u=[],m.cacheSize&&w[o])return w[o].i=_++,w[o].results;0===e.q.length&&0===e.index.length?(l(i,function(e){u.push(e)}),r=u):(s=n(e.index),l(s,function(t){(0===e.q.length||g(t,e.q))&&u.push(t)}),r=u)}else r=e.results;return!(e.order.length>0)||e.run&&e.sort||(r=v(r,e.order)),r.length&&(e.limit&&e.limit<r.length||e.start)&&(a=[],l(r,function(t,n){if(!e.start||e.start&&n+1>=e.start)if(e.limit){if(c=e.start?n+1-e.start:n,c<e.limit)a.push(t);else if(c>e.limit)return TAFFY.EXIT}else a.push(t)}),r=a),m.cacheSize&&"nocache"!==o&&(F++,setTimeout(function(){var e,t;F>=2*m.cacheSize&&(F=0,e=_-m.cacheSize,t={},f(function(n,r){n.i>=e&&(t[r]=n)}),w=t)},0),w[o]={i:_++,results:r}),r}},r=function(){var e,n;return e=TAFFY.mergeObj(TAFFY.mergeObj(a,{insert:void 0}),{getDBI:function(){return t},getroot:function(e){return r.call(e)},context:function(e){return e&&(n=TAFFY.mergeObj(n,e.hasOwnProperty("results")?TAFFY.mergeObj(e,{run:new Date,sort:new Date}):e)),n},extend:void 0}),n=this&&this.q?this:{limit:!1,start:!1,q:[],filterRaw:[],index:[],order:[],results:!1,run:null,sort:null,settings:m},l(arguments,function(e){p(e)?n.index.push(e):n.q.push(h(e)),n.filterRaw.push(e)
}),e},o++,e&&t.insert(e),r.insert=t.insert,r.merge=function(e,n,i){var o={},u=[],s={};return i=i||!1,n=n||"id",l(e,function(e){var s;o[n]=e[n],u.push(e[n]),s=r(o).first(),s?t.update(s.___id,e,i):t.insert(e,i)}),s[n]=u,r(s)},r.TAFFY=!0,r.sort=t.sort,r.settings=function(e){return e&&(m=TAFFY.mergeObj(m,e),e.template&&r().update(e.template)),m},r.store=function(e){var t,n=!1;return localStorage&&(e&&(t=localStorage.getItem("taffy_"+e),t&&t.length>0&&(r.insert(t),n=!0),i.length>0&&setTimeout(function(){localStorage.setItem("taffy_"+m.storageName,JSON.stringify(i))})),r.settings({storageName:e})),r},r},TAFFY=T,T.each=l,T.eachin=f,T.extend=a.extend,TAFFY.EXIT="TAFFYEXIT",TAFFY.mergeObj=function(e,t){var n={};return f(e,function(t,r){n[r]=e[r]}),f(t,function(e,r){n[r]=t[r]}),n},TAFFY.has=function(e,t){var n,r=!1;if(e.TAFFY)return r=e(t),r.length>0?!0:!1;switch(T.typeOf(e)){case"object":if(T.isObject(t))f(t,function(n,i){return r!==!0||T.isUndefined(e[i])||!e.hasOwnProperty(i)?(r=!1,TAFFY.EXIT):void(r=T.has(e[i],t[i]))});else if(T.isArray(t))l(t,function(n,i){return r=T.has(e,t[i]),r?TAFFY.EXIT:void 0});else if(T.isString(t))return TAFFY.isUndefined(e[t])?!1:!0;return r;case"array":if(T.isObject(t))l(e,function(n,i){return r=T.has(e[i],t),r===!0?TAFFY.EXIT:void 0});else if(T.isArray(t))l(t,function(n,i){return l(e,function(n,o){return r=T.has(e[o],t[i]),r===!0?TAFFY.EXIT:void 0}),r===!0?TAFFY.EXIT:void 0});else if(T.isString(t)||T.isNumber(t))for(r=!1,n=0;n<e.length;n++)if(r=T.has(e[n],t))return!0;return r;case"string":if(T.isString(t)&&t===e)return!0;break;default:if(T.typeOf(e)===T.typeOf(t)&&e===t)return!0}return!1},TAFFY.hasAll=function(e,t){var n,r=TAFFY;return r.isArray(t)?(n=!0,l(t,function(t){return n=r.has(e,t),n===!1?TAFFY.EXIT:void 0}),n):r.has(e,t)},TAFFY.typeOf=function(e){var t=typeof e;return"object"===t&&(e?"number"!=typeof e.length||e.propertyIsEnumerable("length")||(t="array"):t="null"),t},TAFFY.getObjectKeys=function(e){var t=[];return f(e,function(e,n){t.push(n)}),t.sort(),t},TAFFY.isSameArray=function(e,t){return TAFFY.isArray(e)&&TAFFY.isArray(t)&&e.join(",")===t.join(",")?!0:!1},TAFFY.isSameObject=function(e,t){var n=TAFFY,r=!0;return n.isObject(e)&&n.isObject(t)?n.isSameArray(n.getObjectKeys(e),n.getObjectKeys(t))?f(e,function(i,o){return n.isObject(e[o])&&n.isObject(t[o])&&n.isSameObject(e[o],t[o])||n.isArray(e[o])&&n.isArray(t[o])&&n.isSameArray(e[o],t[o])||e[o]===t[o]?void 0:(r=!1,TAFFY.EXIT)}):r=!1:r=!1,r},e=["String","Number","Object","Array","Boolean","Null","Function","Undefined"],t=function(e){return function(t){return TAFFY.typeOf(t)===e.toLowerCase()?!0:!1}},n=0;n<e.length;n++)r=e[n],TAFFY["is"+r]=t(r)}(),"object"==typeof exports&&(exports.taffy=TAFFY);var DrivePass=DrivePass||{};DrivePass.Browser={isChrome:function(){return/Chrome/.test(navigator.userAgent)},ChromeExt:function(){chrome.runtime?chrome.runtime.onMessage||(chrome.runtime.onMessage=chrome.extension.onMessage,chrome.runtime.sendMessage=chrome.extension.sendMessage,chrome.runtime.onConnect=chrome.extension.onConnect,chrome.runtime.connect=chrome.extension.connect):chrome.runtime=chrome.extension},isFirefox:function(){return/Firefox/.test(navigator.userAgent)},sendToPage:function(e){var t=e||{};return 2!==Object.keys(t).length?!1:void(this.isChrome()&&chrome.tabs.getSelected(null,function(e){chrome.tabs.sendMessage(e.id,{password:t.password,username:t.username},function(e){console.log(e.dom)})}))},getActiveTab:function(e){this.isChrome()&&chrome.tabs.query({active:!0,lastFocusedWindow:!0},function(t){var n=t[0];this.activeTabUrl=utils.getHostname(n.url),"function"==typeof e&&e()}.bind(this))},oAuthSendRequest:function(e,t,n){this.isChrome()&&(this.ChromeExt(),chrome.runtime.getBackgroundPage(function(r){r.oauth.sendSignedRequest(e,t,n)}))}};var DrivePass=DrivePass||{};DrivePass.Filters={findPW:function(e,t){var n=e||{},r=[];if(_.keys(n).length>0){for(var i in n)-1!==t.indexOf(n[i].site.trim())&&r.push(n[i].username,n[i].password,n[i].site);return r}throw new Error("findPW: data not an object")},filterResults:function(e){var t=e||{},n=0,r={},i=t.feed.entry,o=DrivePass.Settings.gs_sheet_init.columns;for(var u in i){r[n]={};for(var s=0;s<o.length;s++){var a="gsx$"+o[s];r[n][o[s]]=i[u][a].$t}n++}return r},createDBarray:function(e){var t=e||{},n=0,r=t.feed.entry,i=DrivePass.Settings.gs_sheet_init.columns,o=[];for(var u in r){for(var s={},a=0;a<i.length;a++){var c="gsx$"+i[a];s[i[a]]=r[u][c].$t}o.push(s),n++}return o}};var DrivePass=DrivePass||{};DrivePass.GoogleDrive=function(){var e={};e.driveAPI="https://www.googleapis.com/upload/drive/v2/files";var t=function(e,t){console.log(e),console.log(t)},n=function(e,t){var n="-------314159265358979323846",i="\r\n--"+n+"\r\n",o="\r\n--"+n+"--",u=new FileReader;u.readAsBinaryString(e),u.onload=function(){var n=e.type||"application/octet-stream",s={title:e.fileName,mimeType:n},a=btoa(u.result),c=i+"Content-Type: application/json\r\n\r\n"+JSON.stringify(s)+i+"Content-Type: "+n+"\r\nContent-Transfer-Encoding: base64\r\n\r\n"+a+o;r(c,t)}},r=function(n,r){e.cb="function"==typeof r?r:t;var i="-------314159265358979323846",o={method:"POST",params:{convert:!0,uploadType:"multipart",visibility:"private"},headers:{"Content-Type":'multipart/mixed; boundary="'+i+'"'},body:n};DrivePass.Browser.oAuthSendRequest(e.driveAPI,e.cb,o)},i=function(){var e=new Blob(["site,username,password"],{type:"text/csv",fileName:"DrivePass DB"});n(e,t)};return{init:i}};var DrivePass=DrivePass||{};DrivePass.GoogleSpreadsheet=function(){var e,t={},n=function(n,r){return 200!==r.status?(e={success:!1,message:r.status+": Connection Failed"},console.warn(r)):(e={success:!0,message:"spreadsheet successfully loaded"},e.sheetData=JSON.parse(n)),null!==t.cb&&t.cb(e),e},r=function(e){t.cb="function"==typeof e?e:null;var r={headers:{"GData-Version":"3.0"},parameters:{alt:"json",showfolders:"true"}};DrivePass.Browser.oAuthSendRequest(t.jsonListUrl,n,r)},i=function(e,n){t.cb="function"==typeof n?n:null;var r={method:"POST",headers:{"GData-Version":"3.0","Content-Type":"application/atom+xml"},body:o(e)};DrivePass.Browser.oAuthSendRequest(t.jsonListUrl,a,r)},o=function(e){for(var n='<entry xmlns="http://www.w3.org/2005/Atom" xmlns:gsx="http://schemas.google.com/spreadsheets/2006/extended">\n',r=t.columns,i=0;i<r.length;i++)n+="<gsx:"+r[i]+">"+e[i]+"</gsx:"+r[i]+">\n";return n+="</entry>"},u=function(e,n){var r="<entry xmlns='http://www.w3.org/2005/Atom' xmlns:gsx='http://schemas.google.com/spreadsheets/2006/extended' ";r+="xmlns:gd='http://schemas.google.com/g/2005' gd:etag='"+e.gd$etag+"'>\n",r+="<id>"+e.id.$t+"</id>\n",r+="<updated>"+e.updated.$t+"</updated>\n",r+='<category scheme="http://schemas.google.com/spreadsheets/2006" term="http://schemas.google.com/spreadsheets/2006#list"/>\n',r+="<title type='text'>"+e.title.$t+"</title>\n",r+="<content type='text'>"+e.content.$t+"</content>\n",r+='<link rel="self" type="application/atom+xml" href="'+e.link[0].href+'"/>\n',r+='<link rel="edit" type="application/atom+xml" href="'+e.link[1].href+'"/>\n';for(var i=t.columns,o=0;o<i.length;o++)r+="<gsx:"+i[o]+">"+n[o]+"</gsx:"+i[o]+">\n";return r+="</entry>"},s=function(e,n,r){t.cb="function"==typeof r?r:null;var i={method:"PUT",headers:{"GData-Version":"3.0","Content-Type":"application/atom+xml","if-match":"*"},body:u(e,n)};DrivePass.Browser.oAuthSendRequest(e.link[1].href,c,i)},a=function(n,r){return 201!==r.status?(e={success:!1,message:r.status+": error saving"},console.warn(r)):e={success:!0,message:"saved successfully"},null!==t.cb&&t.cb(e),e},c=function(n,r){return 200!==r.status?(e={success:!1,message:r.status+": error updating"},console.warn(r)):e={success:!0,message:"update successful"},null!==t.cb&&t.cb(e),e},l=function(n,r){return 200!==r.status?(e={success:!1,message:r.status+": error querying"},console.warn(r)):(e={success:!0,message:"query successful"},e.queryData=JSON.parse(n)),null!==t.cb&&t.cb(e),e},f=function(e,n,r){var i=e+"="+n;t.cb="function"==typeof r?r:null;var o={method:"GET",parameters:{alt:"json",sq:i.replace(" ","%20")}};DrivePass.Browser.oAuthSendRequest(t.jsonListUrl,l,o)},p=function(e){if(t=e||{},"string"!=typeof t.sheet_url||"object"!=typeof t.columns)throw new Error("Missing sheet_url or columns from init options");var n,r,i=t.sheet_url;if(i.match(/http(s)*:/)){n=i;try{r=n.match(/key=(.*?)(&|#)/)[1]}catch(o){r=n.match(/(cells|list)\/(.*?)\//)[2]}}else r=i;return t.jsonListUrl="https://spreadsheets.google.com/feeds/list/"+r+"/od6/private/full",t.jsonCellsUrl="https://spreadsheets.google.com/feeds/cells/"+r+"/od6/private/basic",this};return{init:p,load:r,add:i,update:s,query:f}};var DrivePass=DrivePass||{};DrivePass.Options=function(){function e(){var e=r.value,t=n.value;localStorage.setItem("sheet_url",e),localStorage.setItem("app_name",t),DrivePass.Settings.gs_sheet_init.sheet_url=e,DrivePass.ResetLocal().init(function(){i.textContent="Options Saved.",a&&_.delay(chrome.runtime.reload,1e3)})}function t(){var e=localStorage.getItem("sheet_url"),t=localStorage.getItem("app_name");return n.value=t,null===e||""===e?!1:(r.value=e,u.textContent="update",s.href=e,s.style.display="block",void 0)}var n=document.getElementById("appName"),r=document.getElementById("sheet_url"),i=document.getElementById("status"),o=document.getElementById("setAppName"),u=document.getElementById("save"),s=document.getElementById("goToSheet"),a=(document.getElementById("makeSheet"),!1);utils.toggler("inst_link","instructions");var c=localStorage.getItem("app_name");null===c&&(o.classList.add("show"),a=!0),document.addEventListener("DOMContentLoaded",t),u.addEventListener("click",e)};var DrivePass=DrivePass||{};DrivePass.Generator=function(){var e=document.getElementById("uppercase"),t=document.getElementById("lowercase"),n=document.getElementById("numbers"),r=document.getElementById("show_symbols"),i=document.getElementById("symbols"),o=document.getElementById("pw"),u=function(){var o="",u=0,s="",a=document.getElementById("digits").value||26;return 4>a&&(a=4),[e,t,n].forEach(function(e){e.checked===!0&&(s+=e.value,o+=_.sample(e.value),u++)}),r.checked===!0&&(s+=i.value,o+=_.sample(i.value),u++),[a,s,o,u]},s=function(e){e.preventDefault();var t=u(),n=t[0]-t[3],r=t[1],i="";return i=_.sample(r,n).join(""),i+=t[2],o.textContent=_.shuffle(i).join(""),o.className="generated",!0},a=function(){document.getElementById("makePassword").addEventListener("click",s,!1)};return{init:a}};var DrivePass=DrivePass||{};DrivePass.Popup=function(){var e,t=document.getElementById("loading"),n=document.getElementById("status"),r=document.getElementById("un"),i=document.getElementById("pw"),o=document.getElementById("add"),u=document.getElementById("update"),s=document.getElementById("theInfo"),a=document.getElementById("currSite"),c=JSON.parse(localStorage.getItem("_full")),l=DrivePass.Sheet,f=function(e,t){var r=e||"",i=t||"";""!==r&&""!==i&&(n.textContent=i,n.className=r,n.style.display="block")},p=function(e){console.log(e),t.style.display="none",f("success","password found"),r.textContent=utils.encodeHTML(e.username),i.textContent=utils.encodeHTML(e.password),a.textContent=utils.encodeHTML(e.site),DrivePass.Browser.sendToPage({username:e.username,password:e.password}),o.classList.remove("show"),u.classList.add("show")},h=function(){t.style.display="none",f("error","password not found"),utils.toggle(s)},g=function(){o.addEventListener("click",function(){var t=r.textContent,n=i.textContent,o=[e,t,n];l.add(o,function(e){e.success===!1?f("error",e.message):(f("success",e.message),DrivePass.ResetLocal().init())})},!1)},d=function(){u.addEventListener("click",function(){var e=a.textContent,t=v(e),n=r.textContent,o=i.textContent,u=[e,n,o];l.update(t,u,function(e){e.success===!1?f("error",e.message):(f("success",e.message),DrivePass.ResetLocal().init())})},!1)},v=function(e){var t=c.sheetData;for(var n in t.feed.entry)if(t.feed.entry[n].gsx$site.$t===e)return t.feed.entry[n]},m=function(){e=DrivePass.Browser.activeTabUrl.replace("www.","");var t=DrivePass.DB({site:e}).get();0===t.length?h():p(t[0])},y=function(){localStorage.sheet_url&&""!==localStorage.sheet_url?(null===c?DrivePass.ResetLocal().init(function(){DrivePass.Browser.getActiveTab(m)}):DrivePass.Browser.getActiveTab(m),g(),d()):(f("error","no spreadsheet set in options"),chrome.tabs.create({url:"options.html"}))};return{init:y}};var DrivePass=DrivePass||{};DrivePass.ResetLocal=function(){var e=DrivePass.Sheet,t=function(t){e.load(function(e){if(localStorage.setItem("_full",JSON.stringify(e)),e.success===!0){"undefined"!=typeof localStorage.taffy_tdb&&localStorage.removeItem("taffy_tdb");var n=DrivePass.Filters.createDBarray(e.sheetData);DrivePass.DB=TAFFY(n),DrivePass.DB.store("tdb"),"function"==typeof t&&t()}})};return{init:t}};var DrivePass=DrivePass||{};DrivePass.Router=function(){function e(e){this.methods=e,this.process()}return e.prototype.process=function(){this.methods.universal();var e=document.body.dataset.route;if("undefined"!=typeof e){var t=this.methods[e];"function"==typeof t&&t()}},e}();var DrivePass=DrivePass||{};DrivePass.Signal=function(){"use strict";var e={},t=-1,n=function(n,r){e[n]||(e[n]=[]);var i=(++t).toString();return e[n].push({token:i,func:r}),i},r=function(t,n){return e[t]?(setTimeout(function(){for(var r=e[t],i=r?r.length:0;i--;)r[i].func(t,n)},0),!0):!1},i=function(t){for(var n in e)if(e[n])for(var r=0,i=e[n].length;i>r;r++)if(e[n][r].token===t)return e[n].splice(r,1),t;return!1};return{broadcast:r,listen:n,off:i}}();var DrivePass=DrivePass||{};DrivePass.User=function(){var e=function(e){var t=document.querySelector("#row_template"),n=document.importNode(t.content,!0);n.querySelector(".site").textContent=e.site,n.querySelector(".username").textContent=e.username,n.querySelector(".password").textContent=e.password,document.getElementById("db_container").appendChild(n)},t=function(){_.each(DrivePass.DB().get(),function(t,n,r){e(r[n])})},n=function(){t()};return{init:n}};var utils={toggle:function(e){e.classList.contains("show")?e.classList.remove("show"):e.classList.add("show")},toggler:function(e,t){var n=this,r=document.getElementById(t);document.getElementById(e).addEventListener("click",function(){n.toggle(r)},!1)},getHostname:function(e){var t=e||"",n=document.createElement("a");return""!==t?(n.href=t,n.hostname):(console.warn("url undefined"),!1)},encodeHTML:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},addslashes:function(e){return(e+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},getJSON:function(e,t,n){var r,i=new XMLHttpRequest,o=function(){console.log("")},u="function"==typeof t?t:o,s="function"==typeof n?n:o;i.open("GET",e,!1),i.onload=function(){i.status>=200&&i.status<400?(r=JSON.parse(i.responseText),u(r)):s()},i.onerror=function(){s()},i.send(null)}},Fake$=function(e){var t="this is my minimal fake jQuery";if(e){if(window===this)return new Fake$(e);var n=e.charAt(0);if("#"===n)this.el=document.getElementById(e.substring(1));else if("."===n){var r=document.querySelectorAll(e);this.el=Array.prototype.slice.call(r)}else this.el=document.getElementById(e);return this.el}return t},$=Fake$,DrivePass=DrivePass||{};DrivePass.ext=new DrivePass.Router({universal:function(){if(DrivePass.Settings=JSON.parse(localStorage.getItem("options"))||{},DrivePass.Settings.keeplocal=DrivePass.Settings.keeplocal||!0,DrivePass.Settings.route=document.body.dataset.route,DrivePass.Settings.gs_sheet_init={sheet_url:localStorage.getItem("sheet_url"),columns:["site","username","password"]},DrivePass.Sheet=new DrivePass.GoogleSpreadsheet,DrivePass.Sheet.init(DrivePass.Settings.gs_sheet_init),"undefined"!=typeof localStorage.taffy_tdb)DrivePass.DB=TAFFY().store("tdb");else if("undefined"!=typeof localStorage._full){var e=localStorage.getItem("_full");e=DrivePass.Filters.createDBarray(JSON.parse(e).sheetData),DrivePass.DB=TAFFY(e)}else DrivePass.ResetLocal().init()},popup:function(){var e=function(){utils.toggler("showGPoptions","gpOptions"),utils.toggler("showInfo","theInfo"),utils.toggler("show_symbols","hidden_symbols")},t=new DrivePass.Popup,n=new DrivePass.Generator;document.addEventListener("DOMContentLoaded",function(){this.bDone||(this.bDone=!0,n.init(),t.init(),e())})},chrome_options:function(){new DrivePass.Options},user:function(){(new DrivePass.User).init()}});