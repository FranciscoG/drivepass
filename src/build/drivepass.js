(function(){function e(e,t,n){for(var r=(n||0)-1,o=e?e.length:0;++r<o;)if(e[r]===t)return r;return-1}function t(e,t){for(var n=e.criteria,r=t.criteria,o=-1,i=n.length;++o<i;){var u=n[o],s=r[o];if(u!==s){if(u>s||"undefined"==typeof u)return 1;if(s>u||"undefined"==typeof s)return-1}}return e.index-t.index}function n(e){return"\\"+Fn[e]}function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,o=n-t||0,i=Array(0>o?0:o);++r<o;)i[r]=e[t+r];return i}function o(e){return e instanceof o?e:new i(e)}function i(e,t){this.__chain__=!!t,this.__wrapped__=e}function u(e){function t(){if(o){var e=r(o);Ln.apply(e,arguments)}if(this instanceof t){var u=s(n.prototype),a=n.apply(u,e||arguments);return C(a)?a:u}return n.apply(i,e||arguments)}var n=e[0],o=e[2],i=e[4];return t}function s(e){return C(e)?kn(e):{}}function a(e,t,n){if("function"!=typeof e)return $t;if("undefined"==typeof t||!("prototype"in e))return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)};case 4:return function(n,r,o,i){return e.call(t,n,r,o,i)}}return Et(e,t)}function c(e){function t(){var e=f?a:this;if(i){var v=r(i);Ln.apply(v,arguments)}if((u||h)&&(v||(v=r(arguments)),u&&Ln.apply(v,u),h&&v.length<l))return o|=16,c([n,g?o:-4&o,v,null,a,l]);if(v||(v=arguments),p&&(n=e[d]),this instanceof t){e=s(n.prototype);var m=n.apply(e,v);return C(m)?m:e}return n.apply(e,v)}var n=e[0],o=e[1],i=e[2],u=e[3],a=e[4],l=e[5],f=1&o,p=2&o,h=4&o,g=8&o,d=n;return t}function l(e,t){for(var n=-1,r=y(),o=e?e.length:0,i=[];++n<o;){var u=e[n];r(t,u)<0&&i.push(u)}return i}function f(e,t,n,r){for(var o=(r||0)-1,i=e?e.length:0,u=[];++o<i;){var s=e[o];if(s&&"object"==typeof s&&"number"==typeof s.length&&(zn(s)||b(s))){t||(s=f(s,t,n));var a=-1,c=s.length,l=u.length;for(u.length+=c;++a<c;)u[l++]=s[a]}else n||u.push(s)}return u}function p(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;var i=typeof e,u=typeof t;if(!(e!==e||e&&bn[i]||t&&bn[u]))return!1;if(null==e||null==t)return e===t;var s=En.call(e),a=En.call(t);if(s!=a)return!1;switch(s){case gn:case dn:return+e==+t;case mn:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case Tn:case _n:return e==String(t)}var c=s==hn;if(!c){var l=e instanceof o,f=t instanceof o;if(l||f)return p(l?e.__wrapped__:e,f?t.__wrapped__:t,n,r);if(s!=yn)return!1;var h=e.constructor,g=t.constructor;if(h!=g&&!(B(h)&&h instanceof h&&B(g)&&g instanceof g)&&"constructor"in e&&"constructor"in t)return!1}n||(n=[]),r||(r=[]);for(var d=n.length;d--;)if(n[d]==e)return r[d]==t;var v=!0,m=0;if(n.push(e),r.push(t),c){if(m=t.length,v=m==e.length)for(;m--&&(v=p(e[m],t[m],n,r)););}else er(t,function(t,o,i){return Cn.call(i,o)?(m++,!(v=Cn.call(e,o)&&p(e[o],t,n,r))&&sn):void 0}),v&&er(e,function(e,t,n){return Cn.call(n,t)?!(v=--m>-1)&&sn:void 0});return n.pop(),r.pop(),v}function h(e,t){return e+Bn(Jn()*(t-e+1))}function g(e,t,n){for(var r=-1,o=y(),i=e?e.length:0,u=[],s=n?[]:u;++r<i;){var a=e[r],c=n?n(a,r,e):a;(t?!r||s[s.length-1]!==c:o(s,c)<0)&&(n&&s.push(c),u.push(a))}return u}function d(e){return function(t,n,r){var o={};n=Ut(n,r,3);var i=-1,u=t?t.length:0;if("number"==typeof u)for(;++i<u;){var s=t[i];e(o,s,n(s,i,t),t)}else tr(t,function(t,r,i){e(o,t,n(t,r,i),i)});return o}}function v(e,t,n,r,o,i){var s=2&t,a=16&t,l=32&t;if(!s&&!B(e))throw new TypeError;a&&!n.length&&(t&=-17,a=n=!1),l&&!r.length&&(t&=-33,l=r=!1);var f=1==t||17===t?u:c;return f([e,t,n,r,o,i])}function m(e){return Vn[e]}function y(){var t=(t=o.indexOf)===mt?e:t;return t}function T(e){return"function"==typeof e&&In.test(e)}function _(e){return Kn[e]}function b(e){return e&&"object"==typeof e&&"number"==typeof e.length&&En.call(e)==pn||!1}function F(e){if(!e)return e;for(var t=1,n=arguments.length;n>t;t++){var r=arguments[t];if(r)for(var o in r)e[o]=r[o]}return e}function w(e){return C(e)?zn(e)?r(e):F({},e):e}function x(e){if(!e)return e;for(var t=1,n=arguments.length;n>t;t++){var r=arguments[t];if(r)for(var o in r)"undefined"==typeof e[o]&&(e[o]=r[o])}return e}function A(e){var t=[];return er(e,function(e,n){B(e)&&t.push(n)}),t.sort()}function D(e,t){return e?Cn.call(e,t):!1}function S(e){for(var t=-1,n=Wn(e),r=n.length,o={};++t<r;){var i=n[t];o[e[i]]=i}return o}function P(e){return e===!0||e===!1||e&&"object"==typeof e&&En.call(e)==gn||!1}function j(e){return e&&"object"==typeof e&&En.call(e)==dn||!1}function O(e){return e&&1===e.nodeType||!1}function E(e){if(!e)return!0;if(zn(e)||R(e))return!e.length;for(var t in e)if(Cn.call(e,t))return!1;return!0}function I(e,t){return p(e,t)}function Y(e){return Rn(e)&&!Xn(parseFloat(e))}function B(e){return"function"==typeof e}function C(e){return!(!e||!bn[typeof e])}function L(e){return k(e)&&e!=+e}function N(e){return null===e}function k(e){return"number"==typeof e||e&&"object"==typeof e&&En.call(e)==mn||!1}function q(e){return e&&bn[typeof e]&&En.call(e)==Tn||!1}function R(e){return"string"==typeof e||e&&"object"==typeof e&&En.call(e)==_n||!1}function X(e){return"undefined"==typeof e}function U(e){var t=[];er(e,function(e,n){t.push(n)}),t=l(t,f(arguments,!0,!1,1));for(var n=-1,r=t.length,o={};++n<r;){var i=t[n];o[i]=e[i]}return o}function M(e){for(var t=-1,n=Wn(e),r=n.length,o=Array(r);++t<r;){var i=n[t];o[t]=[i,e[i]]}return o}function $(e){for(var t=-1,n=f(arguments,!0,!1,1),r=n.length,o={};++t<r;){var i=n[t];i in e&&(o[i]=e[i])}return o}function J(e){for(var t=-1,n=Wn(e),r=n.length,o=Array(r);++t<r;)o[t]=e[n[t]];return o}function G(e,t){var n=y(),r=e?e.length:0,o=!1;return r&&"number"==typeof r?o=n(e,t)>-1:tr(e,function(e){return(o=e===t)&&sn}),o}function z(e,t,n){var r=!0;t=Ut(t,n,3);var o=-1,i=e?e.length:0;if("number"==typeof i)for(;++o<i&&(r=!!t(e[o],o,e)););else tr(e,function(e,n,o){return!(r=!!t(e,n,o))&&sn});return r}function H(e,t,n){var r=[];t=Ut(t,n,3);var o=-1,i=e?e.length:0;if("number"==typeof i)for(;++o<i;){var u=e[o];t(u,o,e)&&r.push(u)}else tr(e,function(e,n,o){t(e,n,o)&&r.push(e)});return r}function W(e,t,n){t=Ut(t,n,3);var r=-1,o=e?e.length:0;if("number"!=typeof o){var i;return tr(e,function(e,n,r){return t(e,n,r)?(i=e,sn):void 0}),i}for(;++r<o;){var u=e[r];if(t(u,r,e))return u}}function V(e,t){return pt(e,t,!0)}function K(e,t,n){var r=-1,o=e?e.length:0;if(t=t&&"undefined"==typeof n?t:a(t,n,3),"number"==typeof o)for(;++r<o&&t(e[r],r,e)!==sn;);else tr(e,t)}function Q(e,t){var n=e?e.length:0;if("number"==typeof n)for(;n--&&t(e[n],n,e)!==!1;);else{var r=Wn(e);n=r.length,tr(e,function(e,o,i){return o=r?r[--n]:--n,t(i[o],o,i)===!1&&sn})}}function Z(e,t){var n=r(arguments,2),o=-1,i="function"==typeof t,u=e?e.length:0,s=Array("number"==typeof u?u:0);return K(e,function(e){s[++o]=(i?t:e[t]).apply(e,n)}),s}function et(e,t,n){var r=-1,o=e?e.length:0;if(t=Ut(t,n,3),"number"==typeof o)for(var i=Array(o);++r<o;)i[r]=t(e[r],r,e);else i=[],tr(e,function(e,n,o){i[++r]=t(e,n,o)});return i}function tt(e,t,n){var r=-1/0,o=r;"function"!=typeof t&&n&&n[t]===e&&(t=null);var i=-1,u=e?e.length:0;if(null==t&&"number"==typeof u)for(;++i<u;){var s=e[i];s>o&&(o=s)}else t=Ut(t,n,3),K(e,function(e,n,i){var u=t(e,n,i);u>r&&(r=u,o=e)});return o}function nt(e,t,n){var r=1/0,o=r;"function"!=typeof t&&n&&n[t]===e&&(t=null);var i=-1,u=e?e.length:0;if(null==t&&"number"==typeof u)for(;++i<u;){var s=e[i];o>s&&(o=s)}else t=Ut(t,n,3),K(e,function(e,n,i){var u=t(e,n,i);r>u&&(r=u,o=e)});return o}function rt(e,t,n,r){if(!e)return n;var o=arguments.length<3;t=Ut(t,r,4);var i=-1,u=e.length;if("number"==typeof u)for(o&&(n=e[++i]);++i<u;)n=t(n,e[i],i,e);else tr(e,function(e,r,i){n=o?(o=!1,e):t(n,e,r,i)});return n}function ot(e,t,n,r){var o=arguments.length<3;return t=Ut(t,r,4),Q(e,function(e,r,i){n=o?(o=!1,e):t(n,e,r,i)}),n}function it(e,t,n){return t=Ut(t,n,3),H(e,function(e,n,r){return!t(e,n,r)})}function ut(e,t,n){if(e&&"number"!=typeof e.length&&(e=J(e)),null==t||n)return e?e[h(0,e.length-1)]:on;var r=st(e);return r.length=$n(Mn(0,t),r.length),r}function st(e){var t=-1,n=e?e.length:0,r=Array("number"==typeof n?n:0);return K(e,function(e){var n=h(0,++t);r[t]=r[n],r[n]=e}),r}function at(e){var t=e?e.length:0;return"number"==typeof t?t:Wn(e).length}function ct(e,t,n){var r;t=Ut(t,n,3);var o=-1,i=e?e.length:0;if("number"==typeof i)for(;++o<i&&!(r=t(e[o],o,e)););else tr(e,function(e,n,o){return(r=t(e,n,o))&&sn});return!!r}function lt(e,n,r){var o=-1,i=e?e.length:0,u=Array("number"==typeof i?i:0);for(n=Ut(n,r,3),K(e,function(e,t,r){u[++o]={criteria:[n(e,t,r)],index:o,value:e}}),i=u.length,u.sort(t);i--;)u[i]=u[i].value;return u}function ft(e){return zn(e)?r(e):e&&"number"==typeof e.length?et(e):J(e)}function pt(e,t,n){return n&&E(t)?on:(n?W:H)(e,t)}function ht(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var o=e[t];o&&r.push(o)}return r}function gt(e){return l(e,f(arguments,!0,!0,1))}function dt(e,t,n){var o=0,i=e?e.length:0;if("number"!=typeof t&&null!=t){var u=-1;for(t=Ut(t,n,3);++u<i&&t(e[u],u,e);)o++}else if(o=t,null==o||n)return e?e[0]:on;return r(e,0,$n(Mn(0,o),i))}function vt(e,t){return f(e,t)}function mt(t,n,r){if("number"==typeof r){var o=t?t.length:0;r=0>r?Mn(0,o+r):r||0}else if(r){var i=xt(t,n);return t[i]===n?i:-1}return e(t,n,r)}function yt(e,t,n){var o=0,i=e?e.length:0;if("number"!=typeof t&&null!=t){var u=i;for(t=Ut(t,n,3);u--&&t(e[u],u,e);)o++}else o=null==t||n?1:t||o;return r(e,0,$n(Mn(0,i-o),i))}function Tt(){for(var e=[],t=-1,n=arguments.length;++t<n;){var r=arguments[t];(zn(r)||b(r))&&e.push(r)}var o=e[0],i=-1,u=y(),s=o?o.length:0,a=[];e:for(;++i<s;)if(r=o[i],u(a,r)<0){for(var t=n;--t;)if(u(e[t],r)<0)continue e;a.push(r)}return a}function _t(e,t,n){var o=0,i=e?e.length:0;if("number"!=typeof t&&null!=t){var u=i;for(t=Ut(t,n,3);u--&&t(e[u],u,e);)o++}else if(o=t,null==o||n)return e?e[i-1]:on;return r(e,Mn(0,i-o))}function bt(e,t,n){var r=e?e.length:0;for("number"==typeof n&&(r=(0>n?Mn(0,r+n):$n(n,r-1))+1);r--;)if(e[r]===t)return r;return-1}function Ft(e,t,n){e=+e||0,n=+n||1,null==t&&(t=e,e=0);for(var r=-1,o=Mn(0,Yn((t-e)/n)),i=Array(o);++r<o;)i[r]=e,e+=n;return i}function wt(e,t,n){if("number"!=typeof t&&null!=t){var o=0,i=-1,u=e?e.length:0;for(t=Ut(t,n,3);++i<u&&t(e[i],i,e);)o++}else o=null==t||n?1:Mn(0,t);return r(e,o)}function xt(e,t,n,r){var o=0,i=e?e.length:o;for(n=n?Ut(n,r,1):$t,t=n(t);i>o;){var u=o+i>>>1;n(e[u])<t?o=u+1:i=u}return o}function At(){return g(f(arguments,!0,!0))}function Dt(e,t,n,r){return"boolean"!=typeof t&&null!=t&&(r=n,n="function"!=typeof t&&r&&r[t]===e?null:t,t=!1),null!=n&&(n=Ut(n,r,3)),g(e,t,n)}function St(e){return l(e,r(arguments,1))}function Pt(){for(var e=-1,t=tt(ir(arguments,"length")),n=Array(0>t?0:t);++e<t;)n[e]=ir(arguments,e);return n}function jt(e,t){var n=-1,r=e?e.length:0,o={};for(t||!r||zn(e[0])||(t=[]);++n<r;){var i=e[n];t?o[i]=t[n]:i&&(o[i[0]]=i[1])}return o}function Ot(e,t){if(!B(t))throw new TypeError;return function(){return--e<1?t.apply(this,arguments):void 0}}function Et(e,t){return arguments.length>2?v(e,17,r(arguments,2),null,t):v(e,1,null,null,t)}function It(e){for(var t=arguments.length>1?f(arguments,!0,!1,1):A(e),n=-1,r=t.length;++n<r;){var o=t[n];e[o]=v(e[o],1,null,null,e)}return e}function Yt(){for(var e=arguments,t=e.length;t--;)if(!B(e[t]))throw new TypeError;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}}function Bt(e,t,n){var r,o,i,u,s,a,c,l=0,f=!1,p=!0;if(!B(e))throw new TypeError;if(t=Mn(0,t)||0,n===!0){var h=!0;p=!1}else C(n)&&(h=n.leading,f="maxWait"in n&&(Mn(t,n.maxWait)||0),p="trailing"in n?n.trailing:p);var g=function(){var n=t-(ur()-u);if(0>=n){o&&clearTimeout(o);var f=c;o=a=c=on,f&&(l=ur(),i=e.apply(s,r),a||o||(r=s=null))}else a=setTimeout(g,n)},d=function(){a&&clearTimeout(a),o=a=c=on,(p||f!==t)&&(l=ur(),i=e.apply(s,r),a||o||(r=s=null))};return function(){if(r=arguments,u=ur(),s=this,c=p&&(a||!h),f===!1)var n=h&&!a;else{o||h||(l=u);var v=f-(u-l),m=0>=v;m?(o&&(o=clearTimeout(o)),l=u,i=e.apply(s,r)):o||(o=setTimeout(d,v))}return m&&a?a=clearTimeout(a):a||t===f||(a=setTimeout(g,t)),n&&(m=!0,i=e.apply(s,r)),!m||a||o||(r=s=null),i}}function Ct(e){if(!B(e))throw new TypeError;var t=r(arguments,1);return setTimeout(function(){e.apply(on,t)},1)}function Lt(e,t){if(!B(e))throw new TypeError;var n=r(arguments,2);return setTimeout(function(){e.apply(on,n)},t)}function Nt(e,t){var n={};return function(){var r=t?t.apply(this,arguments):an+arguments[0];return Cn.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}}function kt(e){var t,n;if(!B(e))throw new TypeError;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function qt(e){return v(e,16,r(arguments,1))}function Rt(e,t,n){var r=!0,o=!0;if(!B(e))throw new TypeError;return n===!1?r=!1:C(n)&&(r="leading"in n?n.leading:r,o="trailing"in n?n.trailing:o),n={},n.leading=r,n.maxWait=t,n.trailing=o,Bt(e,t,n)}function Xt(e,t){return v(t,16,[e])}function Ut(e,t,n){var r=typeof e;if(null==e||"function"==r)return a(e,t,n);if("object"!=r)return zt(e);var o=Wn(e);return function(t){for(var n=o.length,r=!1;n--&&(r=t[o[n]]===e[o[n]]););return r}}function Mt(e){return null==e?"":String(e).replace(Zn,m)}function $t(e){return e}function Jt(e){K(A(e),function(t){var n=o[t]=e[t];o.prototype[t]=function(){var e=[this.__wrapped__];Ln.apply(e,arguments);var t=n.apply(o,e);return this.__chain__?new i(t,!0):t}})}function Gt(){return wn._=On,this}function zt(e){return function(t){return t[e]}}function Ht(e,t){return null==e&&null==t&&(t=1),e=+e||0,null==t?(t=e,e=0):t=+t||0,e+Bn(Jn()*(t-e+1))}function Wt(e,t){if(e){var n=e[t];return B(n)?e[t]():n}}function Vt(e,t,r){var i=o,u=i.templateSettings;e=String(e||""),r=x({},r,u);var s=0,a="__p += '",c=r.variable,l=RegExp((r.escape||ln).source+"|"+(r.interpolate||ln).source+"|"+(r.evaluate||ln).source+"|$","g");e.replace(l,function(t,r,o,i,u){return a+=e.slice(s,u).replace(fn,n),r&&(a+="' +\n_.escape("+r+") +\n'"),i&&(a+="';\n"+i+";\n__p += '"),o&&(a+="' +\n((__t = ("+o+")) == null ? '' : __t) +\n'"),s=u+t.length,t}),a+="';\n",c||(c="obj",a="with ("+c+" || {}) {\n"+a+"\n}\n"),a="function("+c+") {\nvar __t, __p = '', __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n"+a+"return __p\n}";try{var f=Function("_","return "+a)(i)}catch(p){throw p.source=a,p}return t?f(t):(f.source=a,f)}function Kt(e,t,n){e=(e=+e)>-1?e:0;var r=-1,o=Array(e);for(t=a(t,n,1);++r<e;)o[r]=t(r);return o}function Qt(e){return null==e?"":String(e).replace(Qn,_)}function Zt(e){var t=++un+"";return e?e+t:t}function en(e){return e=new i(e),e.__chain__=!0,e}function tn(e,t){return t(e),e}function nn(){return this.__chain__=!0,this}function rn(){return this.__wrapped__}var on,un=0,sn={},an=+new Date+"",cn=/<%=([\s\S]+?)%>/g,ln=/($^)/,fn=/['\n\r\t\u2028\u2029\\]/g,pn="[object Arguments]",hn="[object Array]",gn="[object Boolean]",dn="[object Date]",vn="[object Function]",mn="[object Number]",yn="[object Object]",Tn="[object RegExp]",_n="[object String]",bn={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},Fn={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},wn=bn[typeof window]&&window||this,xn=bn[typeof exports]&&exports&&!exports.nodeType&&exports,An=bn[typeof module]&&module&&!module.nodeType&&module,Dn=An&&An.exports===xn&&xn,Sn=bn[typeof global]&&global;!Sn||Sn.global!==Sn&&Sn.window!==Sn||(wn=Sn);var Pn=[],jn=Object.prototype,On=wn._,En=jn.toString,In=RegExp("^"+String(En).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Yn=Math.ceil,Bn=Math.floor,Cn=jn.hasOwnProperty,Ln=Pn.push,Nn=jn.propertyIsEnumerable,kn=T(kn=Object.create)&&kn,qn=T(qn=Array.isArray)&&qn,Rn=wn.isFinite,Xn=wn.isNaN,Un=T(Un=Object.keys)&&Un,Mn=Math.max,$n=Math.min,Jn=Math.random;i.prototype=o.prototype;var Gn={};!function(){var e={0:1,length:1};Gn.spliceObjects=(Pn.splice.call(e,0,1),!e[0])}(1),o.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:cn,variable:""},kn||(s=function(){function e(){}return function(t){if(C(t)){e.prototype=t;var n=new e;e.prototype=null}return n||wn.Object()}}()),b(arguments)||(b=function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Cn.call(e,"callee")&&!Nn.call(e,"callee")||!1});var zn=qn||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&En.call(e)==hn||!1},Hn=function(e){var t,n=e,r=[];if(!n)return r;if(!bn[typeof e])return r;for(t in n)Cn.call(n,t)&&r.push(t);return r},Wn=Un?function(e){return C(e)?Un(e):[]}:Hn,Vn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},Kn=S(Vn),Qn=RegExp("("+Wn(Kn).join("|")+")","g"),Zn=RegExp("["+Wn(Vn).join("")+"]","g"),er=function(e,t){var n,r=e,o=r;if(!r)return o;if(!bn[typeof r])return o;for(n in r)if(t(r[n],n,e)===sn)return o;return o},tr=function(e,t){var n,r=e,o=r;if(!r)return o;if(!bn[typeof r])return o;for(n in r)if(Cn.call(r,n)&&t(r[n],n,e)===sn)return o;return o};B(/x/)&&(B=function(e){return"function"==typeof e&&En.call(e)==vn});var nr=d(function(e,t,n){Cn.call(e,n)?e[n]++:e[n]=1}),rr=d(function(e,t,n){(Cn.call(e,n)?e[n]:e[n]=[]).push(t)}),or=d(function(e,t,n){e[n]=t}),ir=et,ur=T(ur=Date.now)&&ur||function(){return(new Date).getTime()};o.after=Ot,o.bind=Et,o.bindAll=It,o.chain=en,o.compact=ht,o.compose=Yt,o.countBy=nr,o.debounce=Bt,o.defaults=x,o.defer=Ct,o.delay=Lt,o.difference=gt,o.filter=H,o.flatten=vt,o.forEach=K,o.functions=A,o.groupBy=rr,o.indexBy=or,o.initial=yt,o.intersection=Tt,o.invert=S,o.invoke=Z,o.keys=Wn,o.map=et,o.max=tt,o.memoize=Nt,o.min=nt,o.omit=U,o.once=kt,o.pairs=M,o.partial=qt,o.pick=$,o.pluck=ir,o.range=Ft,o.reject=it,o.rest=wt,o.shuffle=st,o.sortBy=lt,o.tap=tn,o.throttle=Rt,o.times=Kt,o.toArray=ft,o.union=At,o.uniq=Dt,o.values=J,o.where=pt,o.without=St,o.wrap=Xt,o.zip=Pt,o.collect=et,o.drop=wt,o.each=K,o.extend=F,o.methods=A,o.object=jt,o.select=H,o.tail=wt,o.unique=Dt,o.clone=w,o.contains=G,o.escape=Mt,o.every=z,o.find=W,o.has=D,o.identity=$t,o.indexOf=mt,o.isArguments=b,o.isArray=zn,o.isBoolean=P,o.isDate=j,o.isElement=O,o.isEmpty=E,o.isEqual=I,o.isFinite=Y,o.isFunction=B,o.isNaN=L,o.isNull=N,o.isNumber=k,o.isObject=C,o.isRegExp=q,o.isString=R,o.isUndefined=X,o.lastIndexOf=bt,o.mixin=Jt,o.noConflict=Gt,o.random=Ht,o.reduce=rt,o.reduceRight=ot,o.result=Wt,o.size=at,o.some=ct,o.sortedIndex=xt,o.template=Vt,o.unescape=Qt,o.uniqueId=Zt,o.all=z,o.any=ct,o.detect=W,o.findWhere=V,o.foldl=rt,o.foldr=ot,o.include=G,o.inject=rt,o.first=dt,o.last=_t,o.sample=ut,o.take=dt,o.head=dt,Jt(o),o.VERSION="2.4.1",o.prototype.chain=nn,o.prototype.value=rn,K(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=Pn[e];o.prototype[e]=function(){var e=this.__wrapped__;return t.apply(e,arguments),Gn.spliceObjects||0!==e.length||delete e[0],this}}),K(["concat","join","slice"],function(e){var t=Pn[e];o.prototype[e]=function(){var e=this.__wrapped__,n=t.apply(e,arguments);return this.__chain__&&(n=new i(n),n.__chain__=!0),n}}),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(wn._=o,define(function(){return o})):xn&&An?Dn?(An.exports=o)._=o:xn._=o:wn._=o}).call(this);var TAFFY,exports,T;!function(){var e,t,n,r,o,i,u,s,a,c,l,f,p,h,g,d,v,m,y,_,b,F,w;if(!TAFFY)for(o="2.7",i=1,u="000000",s=1e3,a={},c=function(e){return TAFFY.isArray(e)||TAFFY.isObject(e)?e:JSON.parse(e)},y=function(e,t){return _(e,function(e){return t.indexOf(e)>=0})},_=function(e,t,n){var r=[];return null==e?r:Array.prototype.filter&&e.filter===Array.prototype.filter?e.filter(t,n):(l(e,function(e,o,i){t.call(n,e,o,i)&&(r[r.length]=e)}),r)},w=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},F=function(e){var t=T.isArray(e)?[]:T.isObject(e)?{}:null;if(null===e)return e;for(var n in e)t[n]=w(e[n])?e[n].toString():T.isArray(e[n])||T.isObject(e[n])?F(e[n]):e[n];return t},b=function(e){var t=JSON.stringify(e);return null===t.match(/regex/)?t:JSON.stringify(F(e))},l=function(e,t,n){var r,o,i,u;if(e&&(T.isArray(e)&&1===e.length||!T.isArray(e)))t(T.isArray(e)?e[0]:e,0);else for(i=0,e=T.isArray(e)?e:[e],u=e.length;u>i&&(o=e[i],T.isUndefined(o)&&!n||(r=t(o,i),r!==T.EXIT));i++);},f=function(e,t){var n,r,o=0;for(r in e)if(e.hasOwnProperty(r)&&(n=t(e[r],r,o++),n===T.EXIT))break},a.extend=function(e,t){a[e]=function(){return t.apply(this,arguments)}},p=function(e){var t;return T.isString(e)&&/[t][0-9]*[r][0-9]*/i.test(e)?!0:T.isObject(e)&&e.___id&&e.___s?!0:T.isArray(e)?(t=!0,l(e,function(e){return p(e)?void 0:(t=!1,TAFFY.EXIT)}),t):!1},g=function(e,t){var n=!0;return l(t,function(t){switch(T.typeOf(t)){case"function":if(!t.apply(e))return n=!1,TAFFY.EXIT;break;case"array":n=1===t.length?g(e,t[0]):2===t.length?g(e,t[0])||g(e,t[1]):3===t.length?g(e,t[0])||g(e,t[1])||g(e,t[2]):4===t.length?g(e,t[0])||g(e,t[1])||g(e,t[2])||g(e,t[3]):!1,t.length>4&&l(t,function(t){g(e,t)&&(n=!0)})}}),n},h=function(e){var t=[];return T.isString(e)&&/[t][0-9]*[r][0-9]*/i.test(e)&&(e={___id:e}),T.isArray(e)?(l(e,function(e){t.push(h(e))}),e=function(){var e=this,n=!1;return l(t,function(t){g(e,t)&&(n=!0)}),n}):T.isObject(e)?(T.isObject(e)&&e.___id&&e.___s&&(e={___id:e.___id}),f(e,function(e,n){T.isObject(e)||(e={is:e}),f(e,function(e,r){var o,i=[];o="hasAll"===r?function(e,t){t(e)}:l,o(e,function(e){var t,o=!0;t=function(){var t,i=this[n],u="==",s="!=",a="===",c="<",l=">",f="<=",p=">=",h="!==";return"undefined"==typeof i?!1:(0===r.indexOf("!")&&r!==s&&r!==h&&(o=!1,r=r.substring(1,r.length)),t="regex"===r?e.test(i):"lt"===r||r===c?e>i:"gt"===r||r===l?i>e:"lte"===r||r===f?e>=i:"gte"===r||r===p?i>=e:"left"===r?0===i.indexOf(e):"leftnocase"===r?0===i.toLowerCase().indexOf(e.toLowerCase()):"right"===r?i.substring(i.length-e.length)===e:"rightnocase"===r?i.toLowerCase().substring(i.length-e.length)===e.toLowerCase():"like"===r?i.indexOf(e)>=0:"likenocase"===r?i.toLowerCase().indexOf(e.toLowerCase())>=0:r===a||"is"===r?i===e:r===u?i==e:r===h?i!==e:r===s?i!=e:"isnocase"===r?i.toLowerCase?i.toLowerCase()===e.toLowerCase():i===e:"has"===r?T.has(i,e):"hasall"===r?T.hasAll(i,e):"contains"===r?TAFFY.isArray(i)&&i.indexOf(e)>-1:-1!==r.indexOf("is")||TAFFY.isNull(i)||TAFFY.isUndefined(i)||TAFFY.isObject(e)||TAFFY.isArray(e)?T[r]&&T.isFunction(T[r])&&0===r.indexOf("is")?T[r](i)===e:T[r]&&T.isFunction(T[r])?T[r](i,e):!1:e===i[r],t=t&&!o?!1:t||o?t:!0)},i.push(t)}),t.push(1===i.length?i[0]:function(){var e=this,t=!1;return l(i,function(n){n.apply(e)&&(t=!0)}),t})})}),e=function(){var e=this,n=!0;return n=1!==t.length||t[0].apply(e)?2!==t.length||t[0].apply(e)&&t[1].apply(e)?3!==t.length||t[0].apply(e)&&t[1].apply(e)&&t[2].apply(e)?4!==t.length||t[0].apply(e)&&t[1].apply(e)&&t[2].apply(e)&&t[3].apply(e)?!0:!1:!1:!1:!1,t.length>4&&l(t,function(t){g(e,t)||(n=!1)}),n}):T.isFunction(e)?e:void 0},v=function(e,t){var n=function(e,n){var r=0;return T.each(t,function(t){var o,i,u,s,a;if(o=t.split(" "),i=o[0],u=1===o.length?"logical":o[1],"logical"===u)s=d(e[i]),a=d(n[i]),T.each(s.length<=a.length?s:a,function(e,t){return s[t]<a[t]?(r=-1,TAFFY.EXIT):s[t]>a[t]?(r=1,TAFFY.EXIT):void 0});else if("logicaldesc"===u)s=d(e[i]),a=d(n[i]),T.each(s.length<=a.length?s:a,function(e,t){return s[t]>a[t]?(r=-1,TAFFY.EXIT):s[t]<a[t]?(r=1,TAFFY.EXIT):void 0});else{if("asec"===u&&e[i]<n[i])return r=-1,T.EXIT;if("asec"===u&&e[i]>n[i])return r=1,T.EXIT;if("desc"===u&&e[i]>n[i])return r=-1,T.EXIT;if("desc"===u&&e[i]<n[i])return r=1,T.EXIT}return 0===r&&"logical"===u&&s.length<a.length?r=-1:0===r&&"logical"===u&&s.length>a.length?r=1:0===r&&"logicaldesc"===u&&s.length>a.length?r=-1:0===r&&"logicaldesc"===u&&s.length<a.length&&(r=1),0!==r?T.EXIT:void 0}),r};return e&&e.push?e.sort(n):e},function(){var e={},t=0;d=function(n){return t>s&&(e={},t=0),e["_"+n]||function(){var r,o,i,u=String(n),s=[],a="_",c="";for(r=0,o=u.length;o>r;r++)i=u.charCodeAt(r),i>=48&&57>=i||46===i?("n"!==c&&(c="n",s.push(a.toLowerCase()),a=""),a+=u.charAt(r)):("s"!==c&&(c="s",s.push(parseFloat(a)),a=""),a+=u.charAt(r));return s.push("n"===c?parseFloat(a):a.toLowerCase()),s.shift(),e["_"+n]=s,t++,s}()}}(),m=function(){this.context({results:this.getDBI().query(this.context())})},a.extend("filter",function(){var e=TAFFY.mergeObj(this.context(),{run:null}),t=[];return l(e.q,function(e){t.push(e)}),e.q=t,l(arguments,function(t){e.q.push(h(t)),e.filterRaw.push(t)}),this.getroot(e)}),a.extend("order",function(e){e=e.split(",");var t,n=[];return l(e,function(e){n.push(e.replace(/^\s*/,"").replace(/\s*$/,""))}),t=TAFFY.mergeObj(this.context(),{sort:null}),t.order=n,this.getroot(t)}),a.extend("limit",function(e){var t,n=TAFFY.mergeObj(this.context(),{});return n.limit=e,n.run&&n.sort&&(t=[],l(n.results,function(n,r){return r+1>e?TAFFY.EXIT:void t.push(n)}),n.results=t),this.getroot(n)}),a.extend("start",function(e){var t,n=TAFFY.mergeObj(this.context(),{});return n.start=e,n.run&&n.sort&&!n.limit?(t=[],l(n.results,function(n,r){r+1>e&&t.push(n)}),n.results=t):n=TAFFY.mergeObj(this.context(),{run:null,start:e}),this.getroot(n)}),a.extend("update",function(e,t,n){var r,o=!0,i={},u=arguments;return!TAFFY.isString(e)||2!==arguments.length&&3!==arguments.length?(i=e,2===u.length&&(o=t)):(i[e]=t,3===arguments.length&&(o=n)),r=this,m.call(this),l(this.context().results,function(e){var t=i;TAFFY.isFunction(t)?t=t.apply(TAFFY.mergeObj(e,{})):T.isFunction(t)&&(t=t(TAFFY.mergeObj(e,{}))),TAFFY.isObject(t)&&r.getDBI().update(e.___id,t,o)}),this.context().results.length&&this.context({run:null}),this}),a.extend("remove",function(e){var t=this,n=0;return m.call(this),l(this.context().results,function(e){t.getDBI().remove(e.___id),n++}),this.context().results.length&&(this.context({run:null}),t.getDBI().removeCommit(e)),n}),a.extend("count",function(){return m.call(this),this.context().results.length}),a.extend("callback",function(e,t){if(e){var n=this;setTimeout(function(){m.call(n),e.call(n.getroot(n.context()))},t||0)}return null}),a.extend("get",function(){return m.call(this),this.context().results}),a.extend("stringify",function(){return JSON.stringify(this.get())}),a.extend("first",function(){return m.call(this),this.context().results[0]||!1}),a.extend("last",function(){return m.call(this),this.context().results[this.context().results.length-1]||!1}),a.extend("sum",function(){var e=0,t=this;return m.call(t),l(arguments,function(n){l(t.context().results,function(t){e+=t[n]||0})}),e}),a.extend("min",function(e){var t=null;return m.call(this),l(this.context().results,function(n){(null===t||n[e]<t)&&(t=n[e])}),t}),function(){var e=function(){var e,t,n;return e=function(e,t,n){var r,o,i;switch(2===n.length?(r=e[n[0]],i="===",o=t[n[1]]):(r=e[n[0]],i=n[1],o=t[n[2]]),i){case"===":return r===o;case"!==":return r!==o;case"<":return o>r;case">":return r>o;case"<=":return o>=r;case">=":return r>=o;case"==":return r==o;case"!=":return r!=o;default:throw String(i)+" is not supported"}},t=function(e,t){var n,r,o={};for(n in e)e.hasOwnProperty(n)&&(o[n]=e[n]);for(n in t)t.hasOwnProperty(n)&&"___id"!==n&&"___s"!==n&&(r=TAFFY.isUndefined(o[n])?"":"right_",o[r+String(n)]=t[n]);return o},n=function(n){var r,o,i=arguments,u=i.length,s=[];if("function"!=typeof n.filter){if(!n.TAFFY)throw"TAFFY DB or result not supplied";r=n()}else r=n;return this.context({results:this.getDBI().query(this.context())}),TAFFY.each(this.context().results,function(n){r.each(function(r){var a,c=!0;e:for(o=1;u>o&&(a=i[o],c="function"==typeof a?a(n,r):"object"==typeof a&&a.length?e(n,r,a):!1,c);o++);c&&s.push(t(n,r))})}),TAFFY(s)()}}();a.extend("join",e)}(),a.extend("max",function(e){var t=null;return m.call(this),l(this.context().results,function(n){(null===t||n[e]>t)&&(t=n[e])}),t}),a.extend("select",function(){var e=[],t=arguments;return m.call(this),1===arguments.length?l(this.context().results,function(n){e.push(n[t[0]])}):l(this.context().results,function(n){var r=[];l(t,function(e){r.push(n[e])}),e.push(r)}),e}),a.extend("distinct",function(){var e=[],t=arguments;return m.call(this),1===arguments.length?l(this.context().results,function(n){var r=n[t[0]],o=!1;l(e,function(e){return r===e?(o=!0,TAFFY.EXIT):void 0}),o||e.push(r)}):l(this.context().results,function(n){var r=[],o=!1;l(t,function(e){r.push(n[e])}),l(e,function(e){var n=!0;return l(t,function(t,o){return r[o]!==e[o]?(n=!1,TAFFY.EXIT):void 0}),n?(o=!0,TAFFY.EXIT):void 0}),o||e.push(r)}),e}),a.extend("supplant",function(e,t){var n=[];return m.call(this),l(this.context().results,function(t){n.push(e.replace(/\{([^\{\}]*)\}/g,function(e,n){var r=t[n];return"string"==typeof r||"number"==typeof r?r:e}))}),t?n:n.join("")}),a.extend("each",function(e){return m.call(this),l(this.context().results,e),this}),a.extend("map",function(e){var t=[];return m.call(this),l(this.context().results,function(n){t.push(e(n))}),t}),T=function(e){var t,n,r,o=[],s={},d=1,m={template:!1,onInsert:!1,onUpdate:!1,onRemove:!1,onDBChange:!1,storageName:!1,forcePropertyCase:null,cacheSize:100,name:""},y=new Date,_=0,F=0,w={};return n=function(e){var t=[],r=!1;return 0===e.length?o:(l(e,function(e){T.isString(e)&&/[t][0-9]*[r][0-9]*/i.test(e)&&o[s[e]]&&(t.push(o[s[e]]),r=!0),T.isObject(e)&&e.___id&&e.___s&&o[s[e.___id]]&&(t.push(o[s[e.___id]]),r=!0),T.isArray(e)&&l(e,function(e){l(n(e),function(e){t.push(e)})})}),r&&t.length>1&&(t=[]),t)},t={dm:function(e){return e&&(y=e,w={},_=0,F=0),m.onDBChange&&setTimeout(function(){m.onDBChange.call(o)},0),m.storageName&&setTimeout(function(){localStorage.setItem("taffy_"+m.storageName,JSON.stringify(o))}),y},insert:function(e,n){var a=[],p=[],h=c(e);return l(h,function(e,r){var c,h;return T.isArray(e)&&0===r?(l(e,function(e){a.push("lower"===m.forcePropertyCase?e.toLowerCase():"upper"===m.forcePropertyCase?e.toUpperCase():e)}),!0):(T.isArray(e)?(c={},l(e,function(e,t){c[a[t]]=e}),e=c):T.isObject(e)&&m.forcePropertyCase&&(h={},f(e,function(t,n){h["lower"===m.forcePropertyCase?n.toLowerCase():"upper"===m.forcePropertyCase?n.toUpperCase():n]=e[n]}),e=h),d++,e.___id="T"+String(u+i).slice(-6)+"R"+String(u+d).slice(-6),e.___s=!0,p.push(e.___id),m.template&&(e=T.mergeObj(m.template,e)),o.push(e),s[e.___id]=o.length-1,m.onInsert&&(n||TAFFY.isUndefined(n))&&m.onInsert.call(e),void t.dm(new Date))}),r(p)},sort:function(e){return o=v(o,e.split(",")),s={},l(o,function(e,t){s[e.___id]=t}),t.dm(new Date),!0},update:function(e,n,r){var i,u,a,c,l={};m.forcePropertyCase&&(f(n,function(e,t){l["lower"===m.forcePropertyCase?t.toLowerCase():"upper"===m.forcePropertyCase?t.toUpperCase():t]=e}),n=l),i=o[s[e]],u=T.mergeObj(i,n),a={},c=!1,f(u,function(e,t){(TAFFY.isUndefined(i[t])||i[t]!==e)&&(a[t]=e,c=!0)}),c&&(m.onUpdate&&(r||TAFFY.isUndefined(r))&&m.onUpdate.call(u,o[s[e]],a),o[s[e]]=u,t.dm(new Date))},remove:function(e){o[s[e]].___s=!1},removeCommit:function(e){var n;for(n=o.length-1;n>-1;n--)o[n].___s||(m.onRemove&&(e||TAFFY.isUndefined(e))&&m.onRemove.call(o[n]),s[o[n].___id]=void 0,o.splice(n,1));s={},l(o,function(e,t){s[e.___id]=t}),t.dm(new Date)},query:function(e){var r,i,u,s,a,c;if(m.cacheSize&&(i="",l(e.filterRaw,function(e){return T.isFunction(e)?(i="nocache",TAFFY.EXIT):void 0}),""===i&&(i=b(T.mergeObj(e,{q:!1,run:!1,sort:!1})))),!e.results||!e.run||e.run&&t.dm()>e.run){if(u=[],m.cacheSize&&w[i])return w[i].i=_++,w[i].results;0===e.q.length&&0===e.index.length?(l(o,function(e){u.push(e)}),r=u):(s=n(e.index),l(s,function(t){(0===e.q.length||g(t,e.q))&&u.push(t)}),r=u)}else r=e.results;return!(e.order.length>0)||e.run&&e.sort||(r=v(r,e.order)),r.length&&(e.limit&&e.limit<r.length||e.start)&&(a=[],l(r,function(t,n){if(!e.start||e.start&&n+1>=e.start)if(e.limit){if(c=e.start?n+1-e.start:n,c<e.limit)a.push(t);else if(c>e.limit)return TAFFY.EXIT}else a.push(t)}),r=a),m.cacheSize&&"nocache"!==i&&(F++,setTimeout(function(){var e,t;F>=2*m.cacheSize&&(F=0,e=_-m.cacheSize,t={},f(function(n,r){n.i>=e&&(t[r]=n)}),w=t)},0),w[i]={i:_++,results:r}),r}},r=function(){var e,n;return e=TAFFY.mergeObj(TAFFY.mergeObj(a,{insert:void 0}),{getDBI:function(){return t},getroot:function(e){return r.call(e)},context:function(e){return e&&(n=TAFFY.mergeObj(n,e.hasOwnProperty("results")?TAFFY.mergeObj(e,{run:new Date,sort:new Date}):e)),n},extend:void 0}),n=this&&this.q?this:{limit:!1,start:!1,q:[],filterRaw:[],index:[],order:[],results:!1,run:null,sort:null,settings:m},l(arguments,function(e){p(e)?n.index.push(e):n.q.push(h(e)),n.filterRaw.push(e)
}),e},i++,e&&t.insert(e),r.insert=t.insert,r.merge=function(e,n,o){var i={},u=[],s={};return o=o||!1,n=n||"id",l(e,function(e){var s;i[n]=e[n],u.push(e[n]),s=r(i).first(),s?t.update(s.___id,e,o):t.insert(e,o)}),s[n]=u,r(s)},r.TAFFY=!0,r.sort=t.sort,r.settings=function(e){return e&&(m=TAFFY.mergeObj(m,e),e.template&&r().update(e.template)),m},r.store=function(e){var t,n=!1;return localStorage&&(e&&(t=localStorage.getItem("taffy_"+e),t&&t.length>0&&(r.insert(t),n=!0),o.length>0&&setTimeout(function(){localStorage.setItem("taffy_"+m.storageName,JSON.stringify(o))})),r.settings({storageName:e})),r},r},TAFFY=T,T.each=l,T.eachin=f,T.extend=a.extend,TAFFY.EXIT="TAFFYEXIT",TAFFY.mergeObj=function(e,t){var n={};return f(e,function(t,r){n[r]=e[r]}),f(t,function(e,r){n[r]=t[r]}),n},TAFFY.has=function(e,t){var n,r=!1;if(e.TAFFY)return r=e(t),r.length>0?!0:!1;switch(T.typeOf(e)){case"object":if(T.isObject(t))f(t,function(n,o){return r!==!0||T.isUndefined(e[o])||!e.hasOwnProperty(o)?(r=!1,TAFFY.EXIT):void(r=T.has(e[o],t[o]))});else if(T.isArray(t))l(t,function(n,o){return r=T.has(e,t[o]),r?TAFFY.EXIT:void 0});else if(T.isString(t))return TAFFY.isUndefined(e[t])?!1:!0;return r;case"array":if(T.isObject(t))l(e,function(n,o){return r=T.has(e[o],t),r===!0?TAFFY.EXIT:void 0});else if(T.isArray(t))l(t,function(n,o){return l(e,function(n,i){return r=T.has(e[i],t[o]),r===!0?TAFFY.EXIT:void 0}),r===!0?TAFFY.EXIT:void 0});else if(T.isString(t)||T.isNumber(t))for(r=!1,n=0;n<e.length;n++)if(r=T.has(e[n],t))return!0;return r;case"string":if(T.isString(t)&&t===e)return!0;break;default:if(T.typeOf(e)===T.typeOf(t)&&e===t)return!0}return!1},TAFFY.hasAll=function(e,t){var n,r=TAFFY;return r.isArray(t)?(n=!0,l(t,function(t){return n=r.has(e,t),n===!1?TAFFY.EXIT:void 0}),n):r.has(e,t)},TAFFY.typeOf=function(e){var t=typeof e;return"object"===t&&(e?"number"!=typeof e.length||e.propertyIsEnumerable("length")||(t="array"):t="null"),t},TAFFY.getObjectKeys=function(e){var t=[];return f(e,function(e,n){t.push(n)}),t.sort(),t},TAFFY.isSameArray=function(e,t){return TAFFY.isArray(e)&&TAFFY.isArray(t)&&e.join(",")===t.join(",")?!0:!1},TAFFY.isSameObject=function(e,t){var n=TAFFY,r=!0;return n.isObject(e)&&n.isObject(t)?n.isSameArray(n.getObjectKeys(e),n.getObjectKeys(t))?f(e,function(o,i){return n.isObject(e[i])&&n.isObject(t[i])&&n.isSameObject(e[i],t[i])||n.isArray(e[i])&&n.isArray(t[i])&&n.isSameArray(e[i],t[i])||e[i]===t[i]?void 0:(r=!1,TAFFY.EXIT)}):r=!1:r=!1,r},e=["String","Number","Object","Array","Boolean","Null","Function","Undefined"],t=function(e){return function(t){return TAFFY.typeOf(t)===e.toLowerCase()?!0:!1}},n=0;n<e.length;n++)r=e[n],TAFFY["is"+r]=t(r)}(),"object"==typeof exports&&(exports.taffy=TAFFY);var DrivePass=DrivePass||{};DrivePass.Browser={isChrome:function(){return/Chrome/.test(navigator.userAgent)},ChromeExt:function(){chrome.runtime?chrome.runtime.onMessage||(chrome.runtime.onMessage=chrome.extension.onMessage,chrome.runtime.sendMessage=chrome.extension.sendMessage,chrome.runtime.onConnect=chrome.extension.onConnect,chrome.runtime.connect=chrome.extension.connect):chrome.runtime=chrome.extension},isFirefox:function(){return/Firefox/.test(navigator.userAgent)},sendToPage:function(e){var t=e||{};return 2!==Object.keys(t).length?!1:void(this.isChrome()&&chrome.tabs.getSelected(null,function(e){chrome.tabs.sendMessage(e.id,{password:t.password,username:t.username},function(e){console.log(e.dom)})}))},getActiveTab:function(e){this.isChrome()&&chrome.tabs.query({active:!0,lastFocusedWindow:!0},function(t){var n=t[0];this.activeTabUrl=utils.getHostname(n.url),"function"==typeof e&&e()}.bind(this))},oAuthSendRequest:function(e,t,n){this.isChrome()&&(this.ChromeExt(),chrome.runtime.getBackgroundPage(function(r){r.oauth.sendSignedRequest(e,t,n)}))}};var DrivePass=DrivePass||{};DrivePass.Filters={findPW:function(e,t){var n=e||{},r=[];if(_.keys(n).length>0){for(var o in n)-1!==t.indexOf(n[o].site.trim())&&r.push(n[o].username,n[o].password,n[o].site);return r}throw new Error("findPW: data not an object")},filterResults:function(e){var t=e||{},n=0,r={},o=t.feed.entry,i=DrivePass.Settings.gs_sheet_init.columns;for(var u in o){r[n]={};for(var s=0;s<i.length;s++){var a="gsx$"+i[s];r[n][i[s]]=o[u][a].$t}n++}return r},createDBarray:function(e){var t=e||{},n=0,r=t.feed.entry,o=DrivePass.Settings.gs_sheet_init.columns,i=[];for(var u in r){for(var s={},a=0;a<o.length;a++){var c="gsx$"+o[a];s[o[a]]=r[u][c].$t}i.push(s),n++}return i}};var DrivePass=DrivePass||{};DrivePass.GoogleDrive=function(){var e={};e.driveAPI="https://www.googleapis.com/upload/drive/v2/files";var t=function(e,t){console.log(e),console.log(t)},n=function(e,t){var n="-------314159265358979323846",o="\r\n--"+n+"\r\n",i="\r\n--"+n+"--",u=new FileReader;u.readAsBinaryString(e),u.onload=function(){var n=e.type||"application/octet-stream",s={title:e.fileName,mimeType:n},a=btoa(u.result),c=o+"Content-Type: application/json\r\n\r\n"+JSON.stringify(s)+o+"Content-Type: "+n+"\r\nContent-Transfer-Encoding: base64\r\n\r\n"+a+i;r(c,t)}},r=function(n,r){e.cb="function"==typeof r?r:t;var o="-------314159265358979323846",i={method:"POST",params:{convert:!0,uploadType:"multipart",visibility:"private"},headers:{"Content-Type":'multipart/mixed; boundary="'+o+'"'},body:n};DrivePass.Browser.oAuthSendRequest(e.driveAPI,e.cb,i)},o=function(){var e=new Blob(["site,username,password"],{type:"text/csv",fileName:"DrivePass DB"});n(e,t)};return{init:o}};var DrivePass=DrivePass||{};DrivePass.GoogleSpreadsheet=function(){var e,t={},n=function(n,r){return 200!==r.status?(e={success:!1,message:r.status+": Connection Failed"},console.warn(r)):(e={success:!0,message:"spreadsheet successfully loaded"},e.sheetData=JSON.parse(n)),null!==t.cb&&t.cb(e),e},r=function(e){t.cb="function"==typeof e?e:null;var r={headers:{"GData-Version":"3.0"},parameters:{alt:"json",showfolders:"true"}};DrivePass.Browser.oAuthSendRequest(t.jsonListUrl,n,r)},o=function(e,n){t.cb="function"==typeof n?n:null;var r={method:"POST",headers:{"GData-Version":"3.0","Content-Type":"application/atom+xml"},body:i(e)};DrivePass.Browser.oAuthSendRequest(t.jsonListUrl,a,r)},i=function(e){for(var n='<entry xmlns="http://www.w3.org/2005/Atom" xmlns:gsx="http://schemas.google.com/spreadsheets/2006/extended">\n',r=t.columns,o=0;o<r.length;o++)n+="<gsx:"+r[o]+">"+e[o]+"</gsx:"+r[o]+">\n";return n+="</entry>"},u=function(e,n){var r="<entry xmlns='http://www.w3.org/2005/Atom' xmlns:gsx='http://schemas.google.com/spreadsheets/2006/extended' ";r+="xmlns:gd='http://schemas.google.com/g/2005' gd:etag='"+e.gd$etag+"'>\n",r+="<id>"+e.id.$t+"</id>\n",r+="<updated>"+e.updated.$t+"</updated>\n",r+='<category scheme="http://schemas.google.com/spreadsheets/2006" term="http://schemas.google.com/spreadsheets/2006#list"/>\n',r+="<title type='text'>"+e.title.$t+"</title>\n",r+="<content type='text'>"+e.content.$t+"</content>\n",r+='<link rel="self" type="application/atom+xml" href="'+e.link[0].href+'"/>\n',r+='<link rel="edit" type="application/atom+xml" href="'+e.link[1].href+'"/>\n';for(var o=t.columns,i=0;i<o.length;i++)r+="<gsx:"+o[i]+">"+n[i]+"</gsx:"+o[i]+">\n";return r+="</entry>"},s=function(e,n,r){t.cb="function"==typeof r?r:null;var o={method:"PUT",headers:{"GData-Version":"3.0","Content-Type":"application/atom+xml","if-match":"*"},body:u(e,n)};DrivePass.Browser.oAuthSendRequest(e.link[1].href,c,o)},a=function(n,r){return 201!==r.status?(e={success:!1,message:r.status+": error saving"},console.warn(r)):e={success:!0,message:"saved successfully"},null!==t.cb&&t.cb(e),e},c=function(n,r){return 200!==r.status?(e={success:!1,message:r.status+": error updating"},console.warn(r)):e={success:!0,message:"update successful"},null!==t.cb&&t.cb(e),e},l=function(n,r){return 200!==r.status?(e={success:!1,message:r.status+": error querying"},console.warn(r)):(e={success:!0,message:"query successful"},e.queryData=JSON.parse(n)),null!==t.cb&&t.cb(e),e},f=function(e,n,r){var o=e+"="+n;t.cb="function"==typeof r?r:null;var i={method:"GET",parameters:{alt:"json",sq:o.replace(" ","%20")}};DrivePass.Browser.oAuthSendRequest(t.jsonListUrl,l,i)},p=function(e){if(t=e||{},"string"!=typeof t.sheet_url||"object"!=typeof t.columns)throw new Error("Missing sheet_url or columns from init options");var n,r,o=t.sheet_url;if(o.match(/http(s)*:/)){n=o;try{r=n.match(/key=(.*?)(&|#)/)[1]}catch(i){r=n.match(/(cells|list)\/(.*?)\//)[2]}}else r=o;return t.jsonListUrl="https://spreadsheets.google.com/feeds/list/"+r+"/od6/private/full",t.jsonCellsUrl="https://spreadsheets.google.com/feeds/cells/"+r+"/od6/private/basic",this};return{init:p,load:r,add:o,update:s,query:f}};var DrivePass=DrivePass||{};DrivePass.Options=function(){function e(){var e=r.value,t=n.value;localStorage.setItem("sheet_url",e),localStorage.setItem("app_name",t),DrivePass.Settings.gs_sheet_init.sheet_url=e,DrivePass.ResetLocal().init(function(){o.textContent="Options Saved.",a&&_.delay(chrome.runtime.reload,1e3)})}function t(){var e=localStorage.getItem("sheet_url"),t=localStorage.getItem("app_name");return n.value=t,null===e||""===e?!1:(r.value=e,u.textContent="update",s.href=e,s.style.display="block",void 0)}var n=document.getElementById("appName"),r=document.getElementById("sheet_url"),o=document.getElementById("status"),i=document.getElementById("setAppName"),u=document.getElementById("save"),s=document.getElementById("goToSheet"),a=(document.getElementById("makeSheet"),!1);utils.toggler("inst_link","instructions");var c=localStorage.getItem("app_name");null===c&&(i.classList.add("show"),a=!0),document.addEventListener("DOMContentLoaded",t),u.addEventListener("click",e)};var DrivePass=DrivePass||{};DrivePass.Generator=function(){var e=document.getElementById("uppercase"),t=document.getElementById("lowercase"),n=document.getElementById("numbers"),r=document.getElementById("show_symbols"),o=document.getElementById("symbols"),i=document.getElementById("pw"),u=function(){var i="",u=0,s="",a=document.getElementById("digits").value||26;return 4>a&&(a=4),[e,t,n].forEach(function(e){e.checked===!0&&(s+=e.value,i+=_.sample(e.value),u++)}),r.checked===!0&&(s+=o.value,i+=_.sample(o.value),u++),[a,s,i,u]},s=function(e){e.preventDefault();var t=u(),n=t[0]-t[3],r=t[1],o="";return o=_.sample(r,n).join(""),o+=t[2],i.textContent=_.shuffle(o).join(""),i.className="generated",!0},a=function(){document.getElementById("makePassword").addEventListener("click",s,!1)};return{init:a}};var DrivePass=DrivePass||{};DrivePass.Popup=function(){var e,t=document.getElementById("loading"),n=document.getElementById("status"),r=document.getElementById("un"),o=document.getElementById("pw"),i=document.getElementById("add"),u=document.getElementById("update"),s=document.getElementById("theInfo"),a=document.getElementById("currSite"),c=JSON.parse(localStorage.getItem("_full")),l=new DrivePass.GoogleSpreadsheet;l.init(DrivePass.Settings.gs_sheet_init);var f=function(e,t){var r=e||"",o=t||"";""!==r&&""!==o&&(n.textContent=o,n.className=r,n.style.display="block")},p=function(e){console.log(e),t.style.display="none",f("success","password found"),r.textContent=utils.encodeHTML(e.username),o.textContent=utils.encodeHTML(e.password),a.textContent=utils.encodeHTML(e.site),DrivePass.Browser.sendToPage({username:e.username,password:e.password}),i.classList.remove("show"),u.classList.add("show")},h=function(){t.style.display="none",f("error","password not found"),utils.toggle(s)},g=function(){i.addEventListener("click",function(){var t=document.getElementById("un").textContent,n=document.getElementById("pw").textContent,r=[e,t,n];l.add(r,function(e){e.success===!1?f("error",e.message):(f("success",e.message),DrivePass.ResetLocal().init())})},!1)},d=function(){u.addEventListener("click",function(){var e=a.textContent,t=v(e),n=document.getElementById("un").textContent,r=document.getElementById("pw").textContent,o=[e,n,r];l.update(t,o,function(e){e.success===!1?f("error",e.message):(f("success",e.message),DrivePass.ResetLocal().init())})},!1)},v=function(e){var t=c.sheetData;for(var n in t.feed.entry)if(t.feed.entry[n].gsx$site.$t===e)return t.feed.entry[n]},m=function(){e=DrivePass.Browser.activeTabUrl.replace("www.","");var t=DrivePass.DB({site:e}).get();0===t.length?h():p(t[0])},y=function(){localStorage.sheet_url&&""!==localStorage.sheet_url?(null===c?DrivePass.ResetLocal().init(function(){DrivePass.Browser.getActiveTab(m)}):DrivePass.Browser.getActiveTab(m),g(),d()):(f("error","no spreadsheet set in options"),chrome.tabs.create({url:"options.html"}))};return{init:y}};var DrivePass=DrivePass||{};DrivePass.ResetLocal=function(){var e=new DrivePass.GoogleSpreadsheet;e.init(DrivePass.Settings.gs_sheet_init);var t=function(t){e.load(function(e){if(localStorage.setItem("_full",JSON.stringify(e)),e.success===!0){"undefined"!=typeof localStorage.taffy_tdb&&localStorage.removeItem("taffy_tdb");var n=DrivePass.Filters.createDBarray(e.sheetData);DrivePass.DB=TAFFY(n),DrivePass.DB.store("tdb"),"function"==typeof t&&t()}})};return{init:t}};var DrivePass=DrivePass||{};DrivePass.Router=function(){function e(e){this.methods=e,this.process()}return e.prototype.process=function(){this.methods.universal();var e=document.body.dataset.route;if("undefined"!=typeof e){var t=this.methods[e];"function"==typeof t&&t()}},e}();var DrivePass=DrivePass||{};DrivePass.Signal=function(){"use strict";var e={},t=-1,n=function(n,r){e[n]||(e[n]=[]);var o=(++t).toString();return e[n].push({token:o,func:r}),o},r=function(t,n){return e[t]?(setTimeout(function(){for(var r=e[t],o=r?r.length:0;o--;)r[o].func(t,n)},0),!0):!1},o=function(t){for(var n in e)if(e[n])for(var r=0,o=e[n].length;o>r;r++)if(e[n][r].token===t)return e[n].splice(r,1),t;return!1};return{broadcast:r,listen:n,off:o}}();var DrivePass=DrivePass||{};DrivePass.User=function(){var e=function(e){var t=document.querySelector("#row_template"),n=document.importNode(t.content,!0);n.querySelector(".site").textContent=e.site,n.querySelector(".username").textContent=e.username,n.querySelector(".password").textContent=e.password,document.getElementById("db_container").appendChild(n)},t=function(){_.each(DrivePass.DB().get(),function(t,n,r){e(r[n])})},n=function(){t()};return{init:n}};var utils={toggle:function(e){e.classList.contains("show")?e.classList.remove("show"):e.classList.add("show")},toggler:function(e,t){var n=this,r=document.getElementById(t);document.getElementById(e).addEventListener("click",function(){n.toggle(r)},!1)},getHostname:function(e){var t=e||"",n=document.createElement("a");return""!==t?(n.href=t,n.hostname):(console.warn("url undefined"),!1)},encodeHTML:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},addslashes:function(e){return(e+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},getJSON:function(e,t,n){var r,o=new XMLHttpRequest,i=function(){console.log("")},u="function"==typeof t?t:i,s="function"==typeof n?n:i;o.open("GET",e,!1),o.onload=function(){o.status>=200&&o.status<400?(r=JSON.parse(o.responseText),u(r)):s()},o.onerror=function(){s()},o.send(null)}},DrivePass=DrivePass||{};DrivePass.ext=new DrivePass.Router({universal:function(){if(DrivePass.Settings=JSON.parse(localStorage.getItem("options"))||{},DrivePass.Settings.keeplocal=DrivePass.Settings.keeplocal||!0,DrivePass.Settings.route=document.body.dataset.route,DrivePass.Settings.gs_sheet_init={sheet_url:localStorage.getItem("sheet_url"),columns:["site","username","password"]},"undefined"!=typeof localStorage.taffy_tdb)DrivePass.DB=TAFFY().store("tdb");else if("undefined"!=typeof localStorage._full){var e=localStorage.getItem("_full");e=DrivePass.Filters.createDBarray(JSON.parse(e).sheetData),DrivePass.DB=TAFFY(e)}else DrivePass.ResetLocal().init()},popup:function(){var e=function(){utils.toggler("showGPoptions","gpOptions"),utils.toggler("showInfo","theInfo"),utils.toggler("show_symbols","hidden_symbols")},t=new DrivePass.Popup,n=new DrivePass.Generator;document.addEventListener("DOMContentLoaded",function(){this.bDone||(this.bDone=!0,n.init(),t.init(),e())})},chrome_options:function(){new DrivePass.Options},user:function(){(new DrivePass.User).init()}});